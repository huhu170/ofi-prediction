# 基于CNN-LSTM的股票价格预测及量化选股研究_李晨阳

## 1）元数据卡（Metadata Card）
- 标题：基于CNN-LSTM的股票价格预测及量化选股研究
- 作者：李晨阳
- 年份：2021
- 期刊/会议：西北大学硕士学位论文
- DOI/URL：【未核验】
- 适配章节（映射到论文大纲，写 1–3 个）：第3章-相关概念与理论基础、第4章-股价预测模型构建、第5章-量化选股策略构建
- 一句话可用结论（必须含证据编号）：CNN-LSTM模型在上证50成分股涨跌预测中表现优于单模型，且基于该模型的选股策略能在牛熊市获得超额收益（依据E1、E2、E5）
- 可复用证据（列出最关键 3–5 条 E 编号）：E1、E2、E3、E4、E5
- 市场/资产（指数/个股/期货/加密等）：上证50指数成分股
- 数据来源（交易所/数据库/公开数据集名称）：JoinQuant聚宽量化交易平台
- 频率（tick/quote/trade/分钟/日等）：日频
- 预测目标（方向/收益/价格变化/波动/冲击等）：股价涨跌方向
- 预测视角（点预测/区间/分类/回归）：分类（二分类：涨/跌）
- 预测步长/窗口（horizon）：未来5个交易日
- 关键特征（尤其 OFI/LOB/交易特征；列出原文术语）：个股基本交易指标（四价一量）、上证50指数指标（四价一量）、个股技术指标（MA、CCI、RSI、W%R、ROC、MACD、ATR、ADX、OBV、MOM）
- 模型与训练（模型族/损失/训练方式/在线或离线）：CNN-LSTM组合模型；损失函数交叉熵；训练方式离线；优化器Adam；Dropout率0.5
- 评价指标（AUC/Accuracy/MAE/RMSE/收益等）：准确率、F0.7-score、策略总收益（TR）、年化收益（TAR）、超额收益（Alpha）、夏普比率（SR）、最大回撤（MD）
- 主要结论（只写可证据支撑的，逐条列点）：
  1. CNN-LSTM模型预测准确率高于单模型（依据E1）；
  2. 基于该模型的选股策略能获得超额收益（依据E2）；
  3. 我国股市未达弱势有效市场（依据E3）；
  4. 策略在牛熊市均有效（依据E5）。
- 局限与适用条件（只写可证据支撑的）：
  1. 调参未用网格搜索，可能错过最优参数（依据E8）；
  2. 样本尺寸较小（20×20），限制特征提取（依据E8）；
  3. 模型更新周期为年，可能弱化时效性（依据E8）。
- 与本论文题目“OFI + 美股指数/代表性个股 + 短期预测”的关联（用证据编号支撑）：【未核验】（原文未涉及OFI/美股，仅研究上证50成分股）


## 2）可追溯证据条目（Evidence Items）
### E1（结果类）
- 定位信息：第4章-第5节-CNN-LSTM模型同其他神经网络模型对比
- 原文关键句：“基于CNN-LSTM两种架构的双模型预测准确度最高，将两种架构相结合可以提升模型的预测效果”
- 我的转述：CNN-LSTM组合模型在上证50成分股涨跌预测中的平均准确率（56.04%）高于CNN（54.15%）、LSTM（53.13%）、BP（53.45%）单模型，说明组合架构能提升预测能力
- 证据等级：A

### E2（结果类）
- 定位信息：第5章-第3节-策略牛熊市表现
- 原文关键句：“方案一选股策略回测中最终获得了192.78%的策略收益，年化收益高达44.47%，相比同期上证50指数基准获得了130.04%的超额收益”
- 我的转述：基于CNN-LSTM模型的方案一选股策略在2018-2020年回测期间总收益192.78%，年化收益44.47%，超额收益130.04%
- 证据等级：A

### E3（结果类）
- 定位信息：研究结论与展望-主要结论部分
- 原文关键句：“我国股票市场不属于弱势有效市场。由于本文构建的CNN-LSTM股价涨跌预测模型的输入变量包含了股票基本交易数据及个股技术指标...说明股票价格并未完全反映所有历史信息”
- 我的转述：作者认为我国股市未达到弱势有效市场，因为基于历史交易数据和技术指标的模型能获得超额收益，表明股价未完全反映历史信息
- 证据等级：A

### E4（方法类）
- 定位信息：第4章-第2节-输入变量特征因子构建
- 原文关键句：“最终得到包括个股基本交易指标、上证50指数指标和个股技术指标在内的共计20个特征因子”
- 我的转述：模型输入特征包括个股四价一量、上证50指数四价一量、10个技术指标（MA、CCI等），共20个因子
- 证据等级：A

### E5（实验类）
- 定位信息：第5章-第3节-策略牛熊市表现
- 原文关键句：“方案一构建的交易策略能在2018年熊市中仍获取正收益（1.16%），在2019-2020年牛市中分别获得85.93%和45.69%的收益”
- 我的转述：该选股策略在熊市（2018）和牛市（2019-2020）均跑赢上证50基准，熊市收益1.16%，牛市分别为85.93%和45.69%
- 证据等级：A

### E6（定义类）
- 定位信息：第4章-第2节-样本标记及数据集划分
- 原文关键句：“按照股票在未来5个交易日后的收益率正负将标签分为上涨和下跌两个类别...独热编码标记为[1,0]（涨）和[0,1]（跌）”
- 我的转述：样本标签定义为未来5个交易日的股价涨跌，采用独热编码表示（涨：[1,0]，跌：[0,1]）
- 证据等级：A

### E7（方法类）
- 定位信息：第4章-第3节-初始模型的网络结构设置
- 原文关键句：“模型由CNN和LSTM两部分组成，通过Lambda层连接，CNN部分参考LeNet-5架构，LSTM层节点数64，全连接层节点数128，Dropout率0.5”
- 我的转述：CNN-LSTM模型结构为CNN（LeNet-5变体，含2层卷积+2层池化）+Lambda层+LSTM（1层64节点）+全连接层（128节点）+Dropout（0.5）+输出层（softmax）
- 证据等级：A

### E8（局限类）
- 定位信息：研究结论与展望-不足部分
- 原文关键句：“受限于实验平台性能，用手动调参替代网格搜索，可能错过最优参数组合；输入样本尺寸仅20×20，限制特征提取能力；模型更新周期为年，可能弱化时效性”
- 我的转述：模型调参未采用网格搜索，输入样本尺寸较小（20×20），模型更新周期较长（年），这些因素可能影响模型效果和策略时效性
- 证据等级：A


## 3）主题笔记（Topic Notes）
### CNN-LSTM模型结构与参数优化
依据E7，模型结合CNN的空间特征提取能力和LSTM的时序处理能力：CNN部分参考LeNet-5架构，含2层卷积（核尺寸2×2，数量16/32）和2层池化（尺寸2×2）；LSTM层设1层64节点；全连接层128节点；Dropout率0.5以缓解过拟合；优化器选用Adam，学习率0.0001；损失函数为交叉熵（适应独热编码标签）。

### 特征因子构建与数据预处理
依据E4、E6，特征因子包括三类共20个：个股基本交易指标（四价一量）、上证50指数指标（四价一量）、个股技术指标（10个）；数据预处理采用Max-Min归一化（缩放到[0,1]）；样本生成采用20天滑动窗口、1天步长，生成20×20的二维样本；标签为未来5天涨跌（独热编码）。

### 模型对比与预测效果分析
依据E1，CNN-LSTM模型的平均预测准确率（56.04%）高于CNN（54.15%）、LSTM（53.13%）、BP（53.45%）单模型，说明组合模型能有效整合空间与时序特征，提升预测能力；模型在测试集的F0.7-score达0.55-0.56，表明其在精确率与召回率上的综合表现良好。

### 量化选股策略设计与回测表现
依据E2、E5，策略设计分两种方案：方案一按涨跌概率前10%选股（5只），周调仓，总收益192.78%，年化收益44.47%，超额收益130.04%，最大回撤14.14%；方案二按阈值选股（上涨概率>0.5854、下跌概率>0.6170），收益较低（总收益162.14%）。策略在牛熊市均有效：熊市（2018）获正收益（1.16%），牛市（2019-2020）获高收益（85.93%/45.69%），且超额收益显著。

### 市场有效性与策略应用价值
依据E3，作者认为我国股市未达到弱势有效市场：基于历史交易数据和技术指标的CNN-LSTM模型能获得超额收益，说明股价未完全反映历史信息，存在可挖掘的交易机会。策略的应用价值体现在：能在不同市场状态下跑赢基准，熊市中控制回撤并获正收益，牛市中放大收益，为投资者提供有效的选股参考。

### 模型局限与改进方向
依据E8，模型存在三方面局限：调参方式（手动替代网格搜索）、样本尺寸（20×20较小）、更新周期（年）。改进方向包括：采用网格搜索或贝叶斯优化调参；增加特征维度（如情绪指标、财务数据）以扩大样本尺寸；缩短模型更新周期（如季度/月度）以提升时效性。


## 4）可直接写进论文的句子草稿（可选）
1. CNN-LSTM组合模型在上证50成分股涨跌预测中的平均准确率达56.04%，显著高于CNN（54.15%）、LSTM（53.13%）及BP（53.45%）单模型（依据E1）。
2. 基于CNN-LSTM模型的方案一选股策略在2018-2020年回测中获得192.78%的总收益，年化收益44.47%，超额收益130.04%，最大回撤控制在14.14%以内（依据E2）。
3. 该策略在熊市（2018）和牛市（2019-2020）均跑赢上证50基准，熊市收益1.16%，牛市分别为85.93%和45.69%，体现了策略的普适性（依据E5）。
4. 模型输入特征包括个股四价一量、上证50指数四价一量及10个技术指标，共20个因子，数据预处理采用Max-Min归一化和20天滑动窗口生成样本（依据E4）。
5. 作者认为我国股市未达到弱势有效市场，因为基于历史交易数据和技术指标的CNN-LSTM模型能获得超额收益，表明股价未完全反映所有历史信息（依据E3）。
