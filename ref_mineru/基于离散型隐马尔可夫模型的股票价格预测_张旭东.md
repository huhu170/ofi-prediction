# 基于离散型隐马尔可夫模型的股票价格预测

张旭东1 黄宇方1 杜家浩1 缪永伟2（1．浙江工业大学 计算机科学与技术学院 ，浙江 杭州310023；2．浙江理工大学 信息工程学院 ，浙江 杭州310018）

摘要 ：通过对股票收益率的统计分析 ，建立离散型隐马尔可夫模型（HMM） ，从而实现了对股票价格的预测 首先，计算某支股票一段时间内当天收盘价相对于前一天收盘价的收益率 ，再将其收益率按照等距离离散化 ，作为 HMM 的输入； 其次， 通过Baum－Welch算法训练 HMM 的参数， 然后利用 Viterbi算法得出观察序列对应的最优隐状态序列 ；最后，根据状态转移矩阵和输出概率矩阵求出后一天收益率的概率分布 ，并通过加权计算得出后一天的收益率 ，再通过收益率计算出对应的股票价格。 实验结果表明 ：基于离散型的隐马尔可夫模型可以更好地预测未来的股价。

关键词 ：隐马尔可夫模型；股票价格预测；离散化中图分类号 ：TP391 文献标志码 ：A文章编号 ：1006－4303（2020）02－0148－06

# StockpriceforecastbasedondiscreteHiddenMarkovModel

ZHANGXudong1，HUANGYufang1，DUJiahao1，MIAOYongwei2 （1．CollegeofComputerScienceandTechnology，ZhejiangUniversityofTechnology，Hangzhou310023，China； 2．CollegeofInformationEngineering， ZhejiangSci－TechUniversity，Hangzhou310018， China）

Abstract： ThispaperproposesastockpriceforecastingmethodbasedondiscreteHiddenMarkov Model（HMM）．Firstly，theyieldoftheclosingpriceofastockoverthepreviousdayrelativeto theclosingpriceofthepreviousdayiscalculated， andthenitsyieldaccordingtotheequidistant distanceastheinputoftheHMMisdiscretized．Secondly， theparametersoftheHMM are performedbytheBaum－Welchalgorithm．Aftertraining， theViterbialgorithmisusedtoobtain thecorrespondingoptimalhiddenstatesequence．Finally，theprobabilitydistributionofthenext day＇srateofreturnisobtainedaccordingtothestatetransitionmatrixandtheoutputprobability matrix， andtheyieldofthenextdayisobtainedbyweighting， andcombinedwithday＇sclosing price， sotheclosingpriceofthestockonthefollowingdaycanbecalculated．Theexperimental resultsshowthatthismethodcanbetterpredictfuturestockprices

Keywords： HiddenMarkovModel； stockpriceforecast； discrete

股票价格的预测是金融领域研究的重点。 但是由于股市的复杂性使得股价预测成为一个很大的难题 股票的价格受到各个方面的因素影响 如银行存款利率 行业因素［1］ 和国家政策等 这些复杂的因素导致投资者在判断一支股票的价格走势时出现了较大的偏差 从而产生了巨大的投资风险 所以建立一个可以智能预测股票价格的模型是很有必要的 在

1970年初，美国统计学家Box等［2］ 提出了以一种时间序列模型ARIMA来预测股价 ARIMA模型结构简单，但是它要求输入的数据必须是线性相关的，这与股票价格非线性变化的特点矛盾，使得ARIMA模型在预测股票价格时准确率不高，应用范围有限。 随后，Engle［3］ 提出了自回归条件异方差模型 ARCH，很好地描述了股票价格波动的不确定性，在经济学领域被广泛的应用 随着近年来人工智能技术的发展，不少智能化算法被广泛地应用到股票价格预测中。 Ke等［4］ 根据股票价格非线性变化的特点，采用BP神经网络对股票数据进行了实证分析，并且使用遗传算法改进了传统BP神经网络的计算精度和收敛速度，取得了良好的预测结果。 但是基于BP神经网络的预测模型 需要优化大量的参数 容易陷入局部极值和产生过拟合的现象。 王卫红等［5］ 提出了PCA－FOA－SVR算法，采用PCA消除股票价格特征的冗余信息，并通过果蝇算法优化SVR的参数，克服了神经网络过拟合、陷入局部最小等缺陷。 但是如何选择一个合适的核函数仍缺乏有效的理论指导

由于股票的价格是一种可观测的时间序列 而决定股票价格的因素属于未知变量。 这个特性和隐马尔科夫模型（HiddenMarkovModel， HMM）相符，不少学者将其应用到股价预测中 HMM 是一个统计模型，最 早 由Baum 等［6－7］ 提 出， 目 前 已 经 在 语 音 识别［8－9］ 、 生物 DNA 序列分析［10－11］ 、 图像处理［12－13］ 和模式识别［14］ 等领 域 有 了 成 熟 的 应 用。 Hassan等［15］ 首次将 HMM应用在金融数据上，他将股票的开盘价、收盘价、最高价和最低价作为 HMM 的观测序列，在训练得到 HMM 的参数后，计算当日股票收盘价在HMM下产生的似然值来寻找历史相似模式，从而对未来股票价格进行了预测。 Gupta等［16］ 利用 Hassan的方法 用股票每日最高价和最低价变化的百分比作为特征训练 HMM，取得了不错的预测效果 与以上所提出的方法不同，笔者将股票的每日收盘价序列转换为 收 益 率 序 列， 然 后 将 其 离 散 化。 对 比 连 续 型HMM，离散型 HMM模型较为简单，参数个数少，可以降低异常值的影响保证模型的稳定性 在预测阶段 不再通过寻找历史相似模式 而是结合 Viterbi［17］算法给出预测结果的概率分布 通过对上证交易所和深圳交易所的部分股票的实证，实验结果表明：笔者提出的方法有着不错的预测效果和指导意义。

# 1 HMM 介绍

# 1．1 HMM 模型概述

HMM 主要由隐状态序列 $( S _ { 1 } , S _ { 2 } , \cdots , S _ { n } )$ 和观测序列 $( O _ { 1 } , O _ { 2 } , \cdots , O _ { n } )$ 组成 隐状态序列是一组含有未知变量的状态序列 ，它的状态是不可见的。每一个隐状态 $S _ { n }$ 仅与上一个隐状态 $S _ { n - 1 }$ 相关，并且与其他状态无关 观测序列是一组直接观测可得的值 ，对于每一个观测值 $O _ { n }$ ，它由与之对应的隐状态 $S _ { n }$ 在一定的概率分布下产生 ，如图1所示

![](images/0e5c6dda8eb5c75aa4b7f325fadde1c65a735dde6367fd6165fc8c8d6d5afa94.jpg)  
图1 隐马尔可夫过程  
Fig．1 HiddenMarkovprocess

# 1．2 HMM 参数

离散型 HMM包含5个参数 ： ${ \bf \chi } _ { ; } \doteq ( { \bf N } , { \bf M } , { \bf A } , { \bf B }$ ，$\pi )$ 。其中：

$N = \{ q _ { 1 } , q _ { 2 } , \cdots , q _ { n } \}$ ：状态的有限集合。

$M = \{ v _ { 1 } , v _ { 2 } , \cdots , v _ { m } \}$ ：观察值的有限集合。

$A = \{ a _ { i j } \} , a _ { i j } = P ( q _ { t } = S _ { j } \mid q _ { t - 1 } = S _ { i } )$ ： 状态转移概率矩阵。

$\pmb { { \cal B } } = \{ b _ { j k } \} , b _ { j k } = P ( O _ { t } = v _ { k } \ | \ q _ { t } = S _ { j } )$ ： 观察值概率分布矩阵。

$\pi = \left\{ \pi _ { i } \right\}$ , $\pi _ { i } = P \{ q _ { 1 } = S _ { i } \}$ ：初始状态概率分布。

1．3 HMM 的3个基本问题

令 $\lambda = \{ A , B , \pi \}$ 为 给 定 HMM 的 参 数， $O =$ $\{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n } \}$ 为观察序列， 则有关于 HMM 的3个基本问题可以描述为

1） 评估问题 ： 对于给定 HMM 模型， 求产生某一个观察序列的概率 $P ( O \mid \lambda )$ ， 该问题可以通过前向－后向算法求解。

2） 解码问题：对于给定HMM模型和观察序列，求产生此观测序列可能性最大的状态序列 $\operatorname* { m a x } _ { Q } \{ P ( Q \mid $ $O , \lambda )$ }，该问题可以通过Viterbi算法求解。

3） 学习问题 ： 对于给定的一个观察序列 $O =$ $\{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n } \}$ ，求解参数 $\lambda = \{ A , B , \pi \}$ ， 使得观察序列产生的概率 $P ( O \mid \lambda )$ 最大 该问题可以通过Baum－Welch算法求解

# 2 算法流程

# 2．1 数据预处理

将股票的每日收盘价序列 $C P = \{ C P _ { 1 } , C P _ { 2 } , \cdots ,$ $\left. C P _ { n } \right\}$ 转换为对应的收益率序列 $\mathrm { R O R } ~ = ~ \{ \mathrm { R O R _ { 1 } }$ ，$\mathrm { R O R _ { 2 } } \ , \cdots , \mathrm { R O R _ { \eta } } \ \}$ ， 即

$$
\mathrm { R O R } _ { n } = \frac { C P _ { n } - C P _ { n - 1 } } { C P _ { n - 1 } }
$$

当输入的观测序列为连续值时，给定隐状态 $S _ { t } = j$ 产生随机观测值 $O _ { t }$ 的概率 $b _ { j } \left( O _ { t } \right)$ 应表示为连续概率密度函数，大部分方法会用正态分布来近似地模拟这种关系 由于股市的复杂性 ，正态分布无法准确地模拟观测值的概率分布 于是笔者采用将股票收益率离散化的方式 ，将 HMM 模型产生的观测值的概率转化为每一个离散值的概率 具体步骤为

1） 求得ROR序列中的最大收益率 max和最小收益率 min。

2） 以收益率等于零为中心点，分别向正方向和负方向划分等距离的区间，直到该区间包含max和 $\operatorname* { m i n }$ 区间的长度如果太长，会导致预测结果误差增大，若区间的长度太短 则区间的数量增多 使得计算量增大根据实验结果，本文中笔者取区间长度为0．001。

3） 将收益率值所落在的区间，将其转换为对应的离散值 其中 $O _ { n }$ 表示转换后的离散值 ，length表示区间长度 即

$$
O _ { n } = [ \frac { \mathrm { R O R } _ { n } - \mathrm { m i n } } { \mathrm { l e n g t h } } ]
$$

# 2．2 HMM 模型训练

将离散化后的观测序列 $O = \{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n } \}$ 作为 HMM的输入来训练 HMM的参数 $\lambda$ 。将观测序列记作 $O$ ，并将相应的隐状态序列记作 $I$ ， 那么问题就转换为求一个具有隐变量的概率模型的解 ，即

$$
P ( O \mid \lambda ) = \sum _ { I } P ( O \mid I , \lambda ) P ( I \mid \lambda )
$$

该模型参数可以通过Baum－Welch算法［18－19］ 计算得到，具体算法为

输入 观测数据 $O = \{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n } \}$

输出 HMM 参数 $\lambda = \{ A , B , \pi \}$

1） 当 $n = 0$ 时，选取 $a _ { i j } ^ { \left( 0 \right) }$ $^ { \mathrm { ~ \tiny ~ ( ~ ) ~ } } , b _ { j } ^ { \scriptscriptstyle ( 0 ) } \left( k \right) , \pi _ { i } ^ { \scriptscriptstyle ( 0 ) }$ 作为模型的初始化参数。

2） 根据公式迭代参数 ，即

$$
\begin{array} { c } { { \displaystyle \sum _ { \alpha _ { \nu } ^ { ( a + 1 ) } } ^ { 2 - 1 } \hat { \xi } _ { \kappa } ( i , j ) } } \\ { { \displaystyle \ a _ { \nu } ^ { ( a + 1 ) } = \left. \frac { \kappa - 1 } { \sum _ { \kappa = 1 } ^ { T - 1 } \gamma _ { \kappa } ( i ) } \right. } } \\ { { \displaystyle \left. \sum _ { \tau _ { i } = 1 } ^ { T } \gamma _ { \kappa } ( i ) \right. } } \\ { { \displaystyle b _ { j } ( k ) ^ { ( a + 1 ) } = \left. \frac { \sum _ { \tau = 1 , 0 , \tau = \nu _ { k } } ^ { T - 1 } \gamma _ { \kappa } ( j ) } { \sum _ { \tau = 1 } ^ { T } \gamma _ { \kappa } ( j ) } \right. } } \\ { { \displaystyle \left. \frac { \kappa - 1 } { \pi _ { i } ^ { ( a + 1 ) } } = \gamma _ { 1 } ( i ) \right. } } \end{array}
$$

3） 当迭代次数达到笔者规定的次数或者参数收敛不 再 变 化 即 可 停 止 迭 代 ， 得 到 模 型 最 终 参 数$\lambda ^ { ( n + 1 ) } = ( \mathbf { A } ^ { ( n + 1 ) } , \pmb { B } ^ { ( n + 1 ) } , \pmb { \pi } ^ { ( n + 1 ) } ) _ { \circ }$

Baum－Welch算法 受 参 数 初 始 值 影 响 较 大 ， 所以在实验中分别随机初始化10组不同的参数 ，对模型进行参数估计，选取 $\log P ( O \mid \lambda )$ 最大的一组参数作为最终的初始化参数

# 2．3 股价预测

在得到训练好的模型后 ， 如何预测未来的股价是一个重要的问题 ， 因为这直接影响到了最后预测的结果 Hassan在历史数据 $O = \{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n - 1 } \}$ 中寻找与当天观测值 $O _ { n }$ 在 $\lambda = \{ A , B , \pi \}$ 下产生的似然值 $L _ { n } = \log P ( O _ { n } \mid \lambda )$ 最接近的似然值 $L _ { i }$ ，并认为第 $i$ 天到第 $i + 1$ 天的收盘价变化和第 $n$ 天到第$n + 1$ 天的收盘价变化具有一定的相似性，于是预测出第 $n + 1$ 天的收盘价 $C P _ { n + 1 }$ ， 即

$$
C P _ { n + 1 } - C P { _ n } = C P { _ { i + 1 } } - C P { _ i }
$$

但是这样的预测方法存在一定的问题。Hassan认为 ：1） 似然值相近的两天， 它们下一天收盘价的变化相似；2） 如果收盘价的变化相似 ， 它们下一天与当天收盘价的差相等 ， 意味着它们的涨跌幅度一样。以上两点都缺乏一定的理论支持 ，从而会造成最后的预测结果出现较大的误差 于是笔者采取了不同的预测方法 ：基于模型的状态转移矩阵 $\mathbf { A }$ 和输出概率矩阵 $\pmb { B }$ 计算出未来一天观测值概率分布 这样使得预测值更有依据 ，从而得到更加精确的预测值

具体地， 通 过 Viterbi算法求出观测序列 $O =$ $\{ O _ { 1 } , O _ { 2 } , \cdots , O _ { n } \}$ 对应 的 最 优 隐 状 态 序 列 $S = \{ S _ { 1 }$ ，$S _ { 2 } \ : , \cdots , S _ { n } \ : \} \ : _ { \circ } S _ { n }$ 即为当天的隐状态， 然后通过状态转移矩阵 $\mathbf { A }$ 计算出后一天最有可能的隐状态 $S _ { n + 1 }$ 。 再结合隐状态 $S _ { n + 1 }$ 对应的输出概率矩阵 $\pmb { B }$ 得到每一个离散值的概率分布。但无论是通过观测隐状态序列$S$ 还是状态转移 矩 阵 $\mathbf { A }$ ， 都可以发现状态的转移存在一定的“惯性” 即同一个状态持续的时间长 ，也就意味着当前状态转移到自身状态的概率会远远大于转移到其他状态的概率。 所以通过状态转移矩阵 $\mathbf { A }$ 得到的隐状态 $S _ { n + 1 }$ 就等于当天的隐状态 $S _ { n }$ 。这样就会忽略当前状态转移到其他状态的情况。 为了解决这个问题，将当前隐状态 $S _ { n }$ 转移到下一个隐状态的转移概率 $a _ { S _ { n } j }$ 作为权重来计算每一个离散值的概率分布，如图2，3所示 具体的计算方法为

$$
P ( O _ { n + 1 } ^ { ( k ) } ) = \sum _ { j = 1 } ^ { N } a _ { S _ { n } j } \cdot b _ { j } ( k )
$$

式中 ： $N$ 表示隐状态个数； $P _ { i }$ 表示每一个离散值 的概 率 。

![](images/619d101dcf187b73b20a2688c0b7fdabe075187916addfcad57d401a76bc39b3.jpg)  
图2 利用状态转移矩阵 $\mathbf { A }$ 和概率输出矩阵 $\mathbf { \delta B }$ 求得第 $n + 1$ 天所有离散值的概率分布  
Fig．2 UsingthestatetransitionmatrixAandtheprobability outputmatrix $\mathbf { \delta B }$ toobtaintheprobabilitydistributionof alldiscretevaluesonthe $^ { n + }$ 1thday

![](images/d864e95c620c23ccd1f73da7cc11295276aeace4cd43d03b612ed2d43b3b86db.jpg)  
图3 所有离散值的概率分布  
Fig．3 Probabilitydistributionofalldiscretevalues

每一个离散值对应一个收益率区间 最后将每个区间的中位数 $\mathrm { m R O R } _ { i }$ 与其对应的概率 $P _ { i }$ 的乘积的累加得到最后预测的收益率 $\mathrm { R O R } _ { n + 1 }$ ， 即

$$
\mathrm { R O R } _ { n + 1 } = \sum _ { i = 1 } ^ { M } \mathrm { m R O R } _ { i } \cdot P _ { i }
$$

式中 $M$ 表示离散值个数。

再将式 （1） 变形， 计算出最终的预测收盘价$C P _ { n + 1 }$ ,即

$$
C P _ { n + 1 } = \mathrm { R O R } _ { n + 1 } \times C P _ { n } + C P _ { n }
$$

# 3 实验结果

笔者选取了3支上证指数的股票作为实证研究 的 样 本 数 据。 这 3 支 股 票 分 别 为 伊 利 股 份（SH600887） 中国平安（SH601318）以及招商银行（SH600036） 将3支股票2015年至2016年的交易数据作为训练集来训 练 HMM 的 参数 选取2017年的交易数据作为测试集来验证模型的有效性 实验中 ， 为了保证预测结果的准确性以及合理性 使用滑动窗口的方式来训练 HMM 参数并进行预测。 具体地 ，将2015年1月1日—2016年12月31日 的 数 据 用 来 训 练 模 型 参 数 ， 预 测 2017年1月1日的收盘价 ； 然后用2015年1月2日—2017年1月1日的数据用来训练模型参数 ， 预测2017年1月2日的收盘价 以此类推 直到2017年12月31日 最终得到2017年所有的预测结果 ，如图 $4 \sim 6$ 所示

![](images/64c9cd5370f077a66a547f61e71bc92ad76ae059cae796f93fcebba30957c65d.jpg)  
图4 伊利股份（SH600887）2017年股价预测值与真实值对比

![](images/5e022f86aa14c7aba265732d2b8f118e5cd4cd344de456b6d4688af971028117.jpg)  
Fig．4 Yilishares（SH600887） 2017stockpriceforecastandactualvaluecomparison  
图5 中国平安（SH601318）2017年股价预测值与真实值对比ig．5 ChinaPingAn （SH601318） 2017stockpriceforecastandactualvaluecompariso

![](images/383ed8f8fa2f8c2c7d25c913872a3359ee575b159e0375a3aeea080ba4f5f322.jpg)  
图6 招商银行（SH600036）2017年股价预测值与真实值对比

为了验证模型的有效性 选取了连续型 HMM模型（即用正态分布近似模拟输出概率矩阵） 、Hassan提出的方法以及SVM 模型作为对比模型并且使用了常见的预测评估指标 ， 即相对误差绝对 值 平 均 MAPE（Meanabsolutepercentageerror）来评 价 不 同 模 型 预 测 结 果 的 有 效 性 。 MAPE定义为

$$
\mathrm { M A P E } = \frac { 1 } { n } \sum _ { i = 1 } ^ { n } \ \frac { \mid y _ { \mathrm { { p r e d i c t } } } - y _ { \mathrm { { t r u t h } } } \mid } { y _ { \mathrm { { t r u t h } } } }
$$

各个模型的预测结果和预测误差如表 $1 \sim 4$ 所 示 。

表1 不同模型对SH600887的预测值  
Table1 DifferentmodelsforthepredictedvalueofSH600887单位 ： 元  

<table><tr><td>日期真实值</td><td></td><td>笔者预 测值</td><td>页连续HMM 预测值</td><td>预测值</td><td>Hassan SVM预 测值</td></tr><tr><td>2017- 01-09</td><td>17.09</td><td>17.24</td><td>16.88</td><td>16.92</td><td>17.34</td></tr><tr><td>2017- 01-10</td><td>17.25</td><td>17.17</td><td>17.12</td><td>17.10</td><td>17.53</td></tr><tr><td>2017-</td><td>17.11</td><td>17.34</td><td>17.38</td><td>17.44</td><td>16.69</td></tr><tr><td>01-11 2017-</td><td>16.93</td><td>16.85</td><td>17.25</td><td>17.08</td><td></td></tr><tr><td>01-12</td><td></td><td></td><td></td><td></td><td>17.23</td></tr><tr><td>2017- 01-13</td><td>17.02</td><td>17.25</td><td>17.42</td><td>17.31</td><td>17.39</td></tr></table>

Fig．6 ChinaMerchantsBank （SH600036） 2017stockpriceforecastandactualvaluecomparison  
表2 不同模型对SH601318的预测值  
Table2 DifferentmodelsforthepredictedvalueofSH601318单位 ： 元  
表3 不同模型对于SH600036预测值  

<table><tr><td>日期</td><td>真实值</td><td>笔者预 测值</td><td>连续HMM 预测值</td><td>Hassan 预测值</td><td>SVM预 测值</td></tr><tr><td>2017- 02-06</td><td>35.24</td><td>34.93</td><td>35.02</td><td>35.43</td><td>34.50</td></tr><tr><td>2017- 02-07</td><td>35.35</td><td>35.50</td><td>35.53</td><td>35.51</td><td>35.61</td></tr><tr><td>2017- 02-08</td><td>35.31</td><td>35.21</td><td>35.43</td><td>35.44</td><td>35.53</td></tr><tr><td>2017- 02-09</td><td>35.40</td><td>35.46</td><td>35.30</td><td>35.24</td><td>34.88</td></tr><tr><td>2017- 02-10</td><td>35.49</td><td>35.49</td><td>35.41</td><td>35.23</td><td>35.00</td></tr></table>

Table3 DifferentmodelsforthepredictedvalueofSH600036单位 ： 元  

<table><tr><td>日期</td><td>真实值</td><td>笔者预 测值</td><td>连续HMM 预测值</td><td>Hassan 预测值</td><td>SVM预 测值</td></tr><tr><td>2017- 04-10</td><td>18.29</td><td>18.13</td><td>18.02</td><td>18.52</td><td>17.84</td></tr><tr><td>2017- 04-11</td><td>18.39</td><td>18.28</td><td>18.17</td><td>18.48</td><td>18.00</td></tr><tr><td>2017- 04-12</td><td>18.42</td><td>18.50</td><td>18.49</td><td>18.22</td><td>18.21</td></tr><tr><td>2017- 04-13</td><td>18.29</td><td>18.24</td><td>18.33</td><td>18.35</td><td>18.54</td></tr><tr><td>2017- 04-14</td><td>18.20</td><td>18.21</td><td>17.97</td><td>18.02</td><td>18.60</td></tr></table>

表4 不同模型的预测误差  
Table4 Predictionerrorofdifferentmodels   

<table><tr><td>股票</td><td>离散型 HMM</td><td>连续型 HMM</td><td>Hassan 方法</td><td>SVM 方法</td></tr><tr><td>伊利股份600887</td><td>0.0105</td><td>0.0154</td><td>0.0138</td><td>0.022</td></tr><tr><td>中国平安601318</td><td>0.0077</td><td>0.0148</td><td>0.0127</td><td>0.027</td></tr><tr><td>招商银行600036</td><td>0.0087</td><td>0.0163</td><td>0.0180</td><td>0.024</td></tr></table>

根据实验结果，发现离散型 HMM 对不同股票价格的预测误差均低于其他3种模型，说明离散型HMM 在股价预测上有着比其他方法更高的精度和稳定性。 与此同时，选取了100支深圳交易所上市的股 票 （SZ300开 头） 和100支 上 证 交 易 所 的 股 票（SH60开头） ，利用笔者所提出的方法进行实验

以每支股票的市值（亿元）作为 $X$ 轴 预测误差指标 MAPE作为 $Y$ 轴建立直角坐标系 如图7所示。 从图7中可以发现 ： 当股票市值大于240亿元时，笔者提出方法的预测误差可以控制在 $1 \%$ 之内，当股票市值小于240亿元时，预测误差会在 $0 \sim 6 \%$ 之间波动。 实验结果表明笔者方法在股票市值大于240亿元时有着较高的预测精度

![](images/887b5f9099864c2e800bdab4bdc09a839ef532e91426a2f4daa47152d261142b.jpg)  
图7 200支股票的预测结果  
Fig．7 Forecastresultsfor200stocks

另外从表5中可以发现 ： 对比来自上证交易所的股票，笔者的预测误差明显小于来自深圳交易所的股票 所以综合以上可知 ： 离散型 HMM 模型对于来自上证交易所中市值较大的股票有着更好的预测精度 。

表5 不同交易所的股票预测误差  
Table5 Stockforecasterrorofdifferentexchanges   

<table><tr><td rowspan="2">误差项</td><td colspan="2">各选100支股票</td></tr><tr><td>深圳交易所300开头</td><td>上证交易所60开头</td></tr><tr><td>MAPE</td><td>0.0415</td><td>0.0083</td></tr></table>

# 4 结 论

提出了一种离散型 HMM 模型，通过将股票的收盘价转换为收益率， 再对收益率离散化作为HMM 的输入 在训练 HMM 参数时， 通过选取多组初始化参数来保证得到更好训练结果 在预测阶段，通过状态转移矩阵和输出概率矩阵计算出后一日预测结果的概率分布 ， 从而得出预测结果。 实验结果表明离散型 HMM 比起现有方法具有更好的预测精度，并且适用于上证交易所中市值较大的股票，可以为投资者提供合理有效的参考。 但是，笔者方法仍旧存在部分缺点需要解决，比如利用Baum－Welch算法训练参数容易陷入局部最优值 ， 训练集的样本长度选取缺乏理论统计等 ， 这些问题将是未来如何改进模型所研究的内容。

# 参考文献 ：

［1］ 周明华 ，俞伟 ， 陆 川．动态网络中行业因素与股市波动性研究［J］．浙江工业大学学报 ，2015，43（3） ：350－354  
［2］ BOXG， JENKINSG．Timeseriesanalysis： forecastingandcon－trol［M］．SanFrancisco： Holden－Day， 1976：2－11  
［3］ ENGLERF．Autoregressiveconditionalheteroscedasticitywithes－timatesofthevarianceofUnitedKingdominflation［J］．Economet－rica， 1982， 50（4） ：987－1007  
［4］ KEJ， LIUX．Empiricalanalysisofoptimalhiddenneuronsinneuralnetworkmodelingforstockprediction［C］／／ProceedingsofthePacific－Asia WorkshoponComputationalIntelligenceandIndustrialApplication．Wuhan： IEEE， 2009：828－832  
［5］ 王 卫 红 ， 卓 鹏 宇．基 于 PCA－FOA－SVR 的股票价格预测研究［J］．浙江工业大学学报 ，2016，44（4） ：399－404  
［6］ BAUMLE， PETRIET．Statisticalinferenceforprobabilisticfunctionsoffinitestate Markovchains［J］．Theannalsofmathematicalstatistics， 1966， 37（6） ：1554－1563  
［7］ BAUMLE， EAGONJA．Aninequalitywithapplicationstostatisticalestimation for probabilisticfunctions of Markovprocessesandtoamodelforecology［J］．BulletinoftheAmer－icanmathematicalsociety， 1967， 73 （3） ：360－363  
［8］ BAHLL， COCKEJ，JELINEKF，etal．Optimaldecodingoflin－earcodesforminimizingsymbolerrorrate（Corresp．） ［J］．IEEEtransactionsoninformationtheory， 2003， 20（2） ：284－287．  
［9］ HOH， MAWARDI VC， DHARMAWAN AB．Questionanswer－ingsystemwithhiddenMarkovmodelspeechrecognition［C］／／Pro－ceedingsoftheInternationalConferenceonScienceinInformationTechnology．Bandung，Indonesia：IEEE， 2018：257－262  
［10］ DURBINR， EDDYSR， KROGH A， etal．Biologicalse－quenceanalysis： probabilisticmodelsofproteinsandnucleicacids［M］．Cambridge： CambridgeUniversityPress， 1998  
［11］ TOTTERDELLJA， NURD， MENGERSENKL．BayesianhiddenMarkovmodelsinDNAsequencesegmentationusingR： thecaseofsimianvacuolatingvirus（SV40） ［J］．Journalofstatisticalcomputation＆simulation， 2017（1） ：1－29  
［12］ QIANXN， YOONBJ．Contour－basedhiddenmarkovmodeltosegment2Dultrasoundimages［C］／／ProceedingsoftheIEEEIn－ternationalConferenceonAcoustics， SpeechandSignalProcess－ing．Prague， CzechRepublic：IEEE， 2011：705－708  
［13］ MARROQUINJL， SANTANAEA， BOTELLOS．Hidden

（下转第211页）

![](images/62ff90cce3fd753e1cb83b26a72c4eb12159b6abbf16c5739612d7825e7ef9df.jpg)  
图9 测试颜色在CIE色度图中的位置  
Fig．9 TestthelocationofthecolorintheCIEchromaticity

# 4 结 论

通过实验 ，研究了新型三基 色 LED灯 的 发 光特性 ，并结合光纤光谱仪 积分球等设备设计制作了色度学实验仪 用恒流源驱动方法实现了3路独立可 调 的 LED电 源 ， 使 得 LED的 发 光 强 度 可调 ，从而 能 够 获 得 更 多 的 颜 色。 根据色度学原理编写程序能够获得相应颜色的色坐标 主波长 补色波长 以 及 色 温 等 信 息。 与 同 类 仪 器 相 比 ， 该 仪器光源可调性好、成 本 低 廉、光 路 简 单、现 象 直 观 ，能够清 晰 验 证 颜 色 相 加 混 合 规 律。 实 验 表 明 ： 用光 纤 光 谱 仪 及 LED灯来演示光颜色的合成实验 ，方法简单快捷、测 量 结 果 准 确 ， 丰 富 了 光 谱 及 色 度学实验的内容 ，在 色 度 学 教 学 实 验 中 ， 能 加 深 学 生对色度测量方法的理解 ， 并能有效提高学生的综合实验能力。

本文得到了浙江工业大学创新性实验项目（浙工大教（2018））的资助。

# 参考文献 ：

［1］ 平澄 ，张仲秋．颜色的混合和匹配演示实验［J］．实 验 技 术 与 管理 ，2008，25（7） ：62－64  
［2］ 朱江 ，陈平 ，刘丽飒 ，等．三基色 LED用于色度学演示实验［J］物理实验 ，2011，31（4） ：5－7  
［3］ 张宪 ，贾广松 ，赵章风 ，等．基于多光谱图像参数的茶叶摊青评价模型研究［J］．浙江工业大学学报 ，2017，45（2） ：125－129  
［4］ 麻佳琪 张孟杨 杨胡江 等．基于三色LED的色匹配实验［J］物理实验 ，2014，34（4） ：42－43  
［5］ 宋晓亮 ，苏来曼 · 艾 ，朱 江．基 于 LED的色度学实验研究［J］大学物理实验 ，2011，24（5） ：35－38  
［6］ 向雪芹．LED光源三基色混色实验方案［J］．实验教学与仪器 ，2016，7（8） ：53－54  
［7］ 魏高尧 卢忠 隋成华．滤光片带宽对光电效应测量普朗克常数的影响［J］．浙江工业大学学报 ，2017，45（3） ：342－346  
［8］ 钱惠国 ，郭海 ，曹利利 ，等．光纤光谱仪测量发光二极管色度实验研究［J］．实验技术与管理 ，2013，30（1） ：63－65  
［9］ 黄翀 ，姜言森 ，欧阳艳东 ，等．LCD 三基色光谱特性的研究［J］光谱学与光谱分析 ，2007，27（12） ：2494－2497  
［10］ 徐丹阳 ，童建平 ，高建勋 ，等．光纤光谱仪光路模拟优化及波长标定［J］．中国激光 201542（5） ：1－5  
［11］ 郑小兵 袁银麟 徐秋云 等．辐射定标的新型参考光源技术［J］．应用光学 ，2012，33（1） ：101－107  
［12］ 李长军 ，催桂华 ，赵达尊 ，等．一种计算色度学三刺激值加权表的新方法［J］．光学学报 ，2003，23（11） ：1346－1353  
［13］ 徐丹阳 ，童建平 ，隋成华 ，等．光栅光谱仪中的高速数据采集系统［J］．浙江工业大学学报 ，2014，42（6） ：690－693

（责任编辑 ：朱小惠）

# （上接第153页）

Markovmeasurefieldmodelsforimagesegmentation［J］IEEEtransactionsonpatternanalysisand machineintelli－gence， 2003， 25（11） ：1380－1387  
［14］ 郭海锋 ，蔡华波 ，朱超 ，等．基于马尔可夫过程的路网交通状态预测方法［J］．浙江工业大学学报 ，2017，45（4） ：421－426  
［15］ HASSAN M R， NATH B．StockmarketforecastingusinghiddenMarkovmodel： anewapproach［C］／／ProceedingsoftheInternationalConferenceonIntelligentSystemsDesignandApplications．Wroclaw， Poland： IEEE， 2005：192－196  
［16］ GUPTA A ， DHINGRAB．Stockmarketpredictionusinghidden Markov models ［C］／／Proceedings of the 2012StudentsConferenceontheEngineeringandSystems．Alla－habad， UttarPradesh， India： IEEE， 2012：1－4  
［17］ VITERBIAJ．Errorboundsforconvolutionalcodesandanasymptoticallyoptimumdecodingalgorithm［J］．IEEEtrans－actionsoninformationtheory， 1967， 13（2） ：260－269  
［18］ BAUMLE， PETRIET， SOULESG， etal．AmaximizationtechniqueoccurringinthestatisticalanalysisofprobabilisticfunctionsofMarkovchains［J］．Annalsofmathematicalsta－tistics， 1970， 41（1） ：164－171  
［19］ BILMESJA．AgentletutorialoftheemalgorithmanditsapplicationtoparameterestimationforgaussianmixtureandhiddenMarkovmodels［R］．Berkeley：InternationalComput－erScienceInstituteandComputerScienceDivision U．CBerkeley， 1998．

（责任编辑 ：朱小惠）