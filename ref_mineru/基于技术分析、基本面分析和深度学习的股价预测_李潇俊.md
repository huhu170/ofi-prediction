# 基于技术分析、基本面分析和深度学习的股价预测

李潇俊，唐攀（东南大学经济管理学院，南京211189)

摘要:文章从深度学习技术角度出发，将技术分析指标、基本面分析指标与混合循环神经网络模型相结合构建新型股价预测模型，并提出滚动样本预测评价法检验股价预测模型的长期有效性。研究发现，相较于以往研究模型，基于LSTM模型和GRU模型构建的混合循环神经网站模型能更有效地提取技术分析指标和基本面分析指标的数据特征，从而给出预测个股股价的最优网络结构；该混合循环神经网络模型在长期预测上具有更高的预测精度。

关键词：股价预测；技术分析；基本面分析；深度学习中图分类号：F222.3;F830.91 文献标识码：A文章编号:1002-6487(2021)24-0146-05

# 0引言

# 1研究方法

在金融时间序列分析中，运用最广泛的计量模型主要有ARIMA模型和GARCH模型[12]。随着机器学习的发展，将机器学习与传统计量模型结合的技术被运用至时间序列分析之中[3—6。熊志斌(2011)[将ARIMA与神经网络融合构建了人民币汇率预测模型；张贵生和张信东(2016)[8将支持向量机(SVM)与GARCH模型结合提出SVM-GARCH预测模型，通过仿真实验验证该模型比传统ARMA-GARCH模型在股票价格预测上具有优势。Buyuksahin 和Ertekina(2019)9运用ARIMA–ANN模型提升了时间序列预测的准确度。当前，深度学习模型成为人工智能领域重点发展的方向，与经济、金融、统计学结合的交叉学科研究相继产生。杨青和王晨蔚(2019)[""运用LSTM模型对全球30个股票开展预测，发现长短期记忆模型(LSTM模型）比ARIMA模型和支持向量回归模型(SVR)具有更好的预测效果。欧阳红兵等(2020)["也运用LSTM模型进行实证分析，验证其预测效果优于多层感知机、支持向量机、K近邻和GARCH模型。

现有大多数股价预测研究[1%-12]在模型输入指标选择及模型预测效果检验方面均采用的是技术分析指标，而未考虑影响股价波动因素还来自基本面分析指标。另外，综合考虑技术分析和基本面分析指标的相关研究在预测模型上并不涉及深度学习["³]。鉴于此，本文基于滚动样本预测法和深度学习模型构建新型股价预测系统，并将其运用至股价预测中，解决以往实证分析在验证预测模型长期有效性方面的局限性。

# 1.1技术分析与基本面分析

在金融学理论中，对于证券市场研究存在两种投资分析方法：技术分析法和基本面分析法。技术分析是一种基于历史统计数据（如历史开盘价、历史收盘价、移动平均线和成交量等)评估和识别股价交易机会和策略的方法。该方法可基于历史交易数据研究股票、期权等任意证券资产。技术分析理论认为过去的交易行为和资产价格变化对于预测证券未来价格走势是至关重要的。与技术分析不同，基本面分析是基于宏观经济状况和行业发展状况等衡量证券的内在价值。如：投资者可以通过一些基本面指标（如无风险利率、行业发展状况、宏观经济指标等)来分析证券的基本面情况，进而决定相应的投资行为和策略。基本面分析的最终目标是发现证券资产是被低估还是高估。

由于金融市场上存在系统性风险和非系统性风险，频繁交易和分散化投资只能降低非系统性风险，对系统性风险是无效的。因此，有必要从金融学理论角度将技术分析指标与基本面分析指标结合来预测股价。

# 1.2滚动样本预测评价法

滚动样本预测评价法基于滚动窗口(Rolling Window)原理。滚动窗口是依据指定的单位长度来构建时间序列。以一步向前滚动样本预测为例：时间序列 $x _ { 1 } , x _ { 2 } , \cdots , x _ { n }$ 用于获取 $x _ { n + 1 }$ 的预测值;时间序列 $x _ { 2 } , x _ { 3 } , \cdots , x _ { n + 1 }$ 用于获取 $x _ { n + 2 }$ 的预测值；以此类推。通过计算预测值与真实值的滚动窗口误差值，该方法能够更为客观、科学评价预测模型的预测效果。

# 财经纵横

# 1.3混合循环神经网络

循环神经网络包含两种典型的变体形式：长短期记忆模型(LSTM)和门控循环单元(GRU）。两种变体形式各具有优缺点：LSTM模型解决了循环神经网络不能长期依赖的问题，而GRU模型相较于LSTM模型参数量小，能够减少过拟合的风险。因此，在预测模型构建上，本文将这两种模型结构进行有机结合搭建基于混合循环神经网络的股价预测系统。该预测系统拓展了以往研究[º""的模型结构，并通过实证分析验证该系统对于由技术指标和基本面指标组成的混合指标的股价预测效果。

长短期记忆模型(LSTM模型)算法如下：

$\tilde { c } _ { t } = \mathrm { t a n h } ( W _ { _ { c } } \cdot [ h _ { _ { t - 1 } } , x _ { t } ] + b _ { _ { c } } ) , i _ { t } = \sigma ( W _ { _ { i } } \cdot [ h _ { _ { t - 1 } } , x _ { t } ] + b _ { i } ) , f _ { t } =$ $\begin{array} { r } { \tau ( \boldsymbol { W } _ { f } \cdot [ \boldsymbol { h } _ { t - 1 } , \boldsymbol { x } _ { t } ] + \boldsymbol { b } _ { f } ) , c _ { t } = f _ { t } ^ { * } c _ { t - 1 } + i _ { t } ^ { * } \tilde { c } _ { t } , o _ { t } = \sigma ( \boldsymbol { W } _ { o } \cdot [ \boldsymbol { h } _ { t - 1 } , \boldsymbol { x } _ { t } ] } \end{array}$ $+ b _ { o } ) , h _ { t } = o _ { t } ^ { * } \operatorname { t a n h } ( c _ { t } )$

其中， $x _ { t }$ 为输入值， $h _ { t - 1 }$ 为上一次的输出值， $\tilde { c } _ { t }$ 为候选记忆单元值， $i _ { t }$ 为输入门， $\sigma$ 为Sigmoid 函数， $c _ { t - 1 }$ 为上一单元的状态值， $f _ { t }$ 是遗忘门， $o _ { t }$ 是输出门， $h _ { t }$ 为输出值，$b _ { c } \ 、 b _ { i } \ 、 b _ { f } \ 、 b _ { o }$ 为偏置， $W _ { c }$ $W _ { i ^ { \setminus } }$ $W _ { f }$ (: $W _ { o }$ 为权重矩阵。

门控循环单元(GRU模型)算法如下：

$z _ { t } = \operatorname { t a n h } ( W _ { z } \cdot [ h _ { t - 1 } , x _ { t } ] ) , r _ { t } = \operatorname { t a n h } ( W _ { r } \cdot [ h _ { t - 1 } , x _ { t } ] ) , \tilde { h } _ { t }$ $= \operatorname { t a n h } ( W \cdot [ r _ { t } ^ { \ast } h _ { t - 1 } , x _ { t } ] ) , h _ { t } = ( 1 - z _ { t } ) ^ { \ast } h _ { t - 1 } + z _ { t } ^ { \ast } \tilde { h } _ { t }$

其中， $z _ { t }$ 为更新门， $r _ { t }$ 为重置门， $h _ { t - 1 }$ 为上一次的输出值， $x _ { t }$ 为门控循环单元的输入值， $W$ 为权重矩阵， $\tilde { h } _ { { t } }$ 是记忆值， $h _ { t }$ 是输出值。

# 1.4误差评价指标

在统计学中，误差评价指标被广泛运用于衡量预测值与真实值之间的差异程度。本文共选取平均绝对误差(MAE）、均方根误差(RMSE）、平均绝对百分比误差(MAPE)和对称平均绝对百分比误差(SMAPE)4种不同的误差评价指标对实证结果进行评价，其计算公式如下：

$$
M A E = \frac { 1 } { n } \sum _ { t = 1 } ^ { n } \left| y _ { t } - \hat { y } _ { t } \right| , R M S E = \sqrt { \frac { 1 } { n } \sum _ { t = 1 } ^ { n } ( y _ { t } - \hat { y } _ { t } ) ^ { 2 } } , M A P E
$$

$$
= 1 0 0 \times \frac { 1 } { n } \sum _ { t = 1 } ^ { n } \lvert \frac { y _ { t } - \hat { y } _ { t } } { y _ { t } } \rvert , S M A P E = 1 0 0 \times \frac { 1 } { n } \sum _ { t = 1 } ^ { n } \frac { \lvert \hat { y } _ { t } - y _ { t } \rvert } { ( \lvert \hat { y } _ { t } \rvert + \lvert y _ { t } \rvert ) / 2 }
$$

其中， $\hat { y } _ { t }$ 为 $t$ 时刻样本的预测值， $y _ { t }$ 为 $t$ 时刻样本的真实值， $n$ 为检验样本的总量。

# 2模型构建

本文构建的混合循环神经网络模型由四层网络结构组成：前三层(网络结构1、网络结构2和网络结构3)是LSTM模型和GRU模型的混合组合，第四层Dense层用于预测值的输出。该模型系统拓展了以往研究[10,1"的模型结构，共包含8种不同的神经网络结构。先通过一元时间序列（由单一收盘价序列组成)检验模型的参数设定及预测效果；再对多元时间序列（收盘价、技术分析指标和基本面分析指标等组成)进行预测分析。在深度学习模型搭建平台选择上，本文基于最新的TensorFlow2.0平台搭建股价预测模型。

2.1以股票收盘价为一元时间序列的股价预测模型

以股票收盘价为单一序列的股价预测模型的示意图如图1所示。具体过程主要分为两部分：第一部分为数据处理，该部分将一元时间序列(单一的收盘价序列)切割成滚动窗口样本。第二部分为深度学习模型的训练与预测，先由三层神经网络结构组成的混合循环神经网络进行训练，再通过Dense层获得滚动预测值。

![](images/a80f65f2f6e6acdca0dbcca1c31b28794a5713e04a55f1984329a51c6e8e2e1e.jpg)  
图1基于混合循环神经网络的一元时间序列预测结构图

2.2多元时间序列股价预测模型

多元时间序列股价预测模型构建的具体过程为（见图2)：首先，在数据处理部分，将收盘价序列、技术分析指标序列和基本面分析指标序列等组合成多元时间序列;其次将其分割成多元滚动窗口样本；然后，通过三层神经网络组成的混合循环神经网络进行训练；最后，由Dense层输出获得滚动预测值。

![](images/dd92032bf897a9d3928f57fbb2cbc54e3f20dec0fc592b75aa4ae62f58f9fa4b.jpg)  
图2基于混合循环神经网络的多元时间序列预测结构图

# 3实证分析

3.1数据来源与处理

大多数预测研究集中于分析国内外股价指数，缺乏对个股预测的相关研究"²，因此，本文以银行业为例，选取中国工商银行(ICBC）、中国建设银行(CCB)和中国银行(BOC)这三家在银行业具有代表性的商业银行为例进行实证分析。这三家银行股价收盘价数据选取的时间范围为2009年10月21日至2019年10月21日，数据来源于国泰安数据库(CSMAR)。本文将收盘价序列的前 $80 \%$ 的数据作为训练样本集，其余作为预测样本集(见下页图3，其中虚线为训练集与预测集的划分线)。下页表1为三家商业银行股价收盘价的描述性统计分析，结果显示，中国工商银行的平均收盘价最高，但因其峰度值最高，其未来股价波动风险最大。

# 3.1.1技术指标选取

本文共选取35个具有代表性的技术分析指标，如7日

# 财经纵横

![](images/a605542245bd8229a61de3081d63587dad154823c6a89f565da0e2ffb954e304.jpg)  
(c)BOC收盘价序列

图3股价收盘价序列图  
表1 股价收盘价序列描述性统计分1  

<table><tr><td>样本</td><td>样本量</td><td>最大值</td><td>最小值</td><td>均值</td><td>标准差</td><td>偏度</td><td>峰度</td></tr><tr><td>ICBC</td><td>2418</td><td>7.75</td><td>3.23</td><td>4.6324</td><td>0.7797</td><td>0.6737</td><td>0.1202</td></tr><tr><td>CCB</td><td>2420</td><td>9.81</td><td>3.78</td><td>5.4787</td><td>1.1567</td><td>0.6543</td><td>-0.3158</td></tr><tr><td>BOC</td><td>2419</td><td>5.60</td><td>2.45</td><td>3.4456</td><td>0.5725</td><td>0.4154</td><td>-0.2229</td></tr></table>

移动平均(MA7)、波动率和收益率等。在此仅选取部分技术指标从经济学和金融学角度解释将其引入技术指标的合理性。

# (1)无风险利率

根据金融学理论中的资本资产定价模型(CAPM)，无风险利率与股价波动之间存在相关关系，具体形式为：

$$
\bar { r } _ { a } = r _ { f } + \beta _ { a } ( \bar { r } _ { m } - r _ { f } )
$$

其中， $\bar { r } _ { a }$ 为证券或证券组合的期望收益率， $r _ { f }$ 为无风险利率， $\beta _ { a }$ 为证券的 $\mathrm { B e t a }$ 系数， ${ \bar { r } _ { m } }$ 为市场期望收益率，$( \bar { r } _ { m } - r _ { f } )$ 为市场溢价。

因股价收盘价序列为日度时间序列，本文将一年期定期存款利率通过复利计算方法转换成日度无风险利率。

(2)个股Amihud指标(ILLIQ)

个股Amihud指标(ILLIQ)由Amihud(2002)[4]提出。该指标反映的是个股的流动性，其计算方式如下：

$$
I L L I Q _ { i y } = \frac { 1 } { D _ { i y } } { \sum _ { t = 1 } ^ { D _ { i y } } } \big | R _ { i y d } \big | V O L D _ { i \nu y d }
$$

其中， $D _ { i y }$ 是股票 $i$ 在第 $y$ 年的交易天数， $R _ { i y d }$ 是股票$i$ 在第 $y$ 年第 $d$ 天的日收益率， $V O L D _ { i \nu y d }$ 是股票 $i$ 在第 $y$ 年第 $d$ 天的日成交量。

样本期内无风险利率和个股Amihud指标的描述性统计检验见表2。

# 3.1.2基本面指标选取

本文选取市场Amihud指标和中国股票市场风险评

表2 无风险利率和个股Amihud指标(ILLIQ)的描述性统计分析  

<table><tr><td>指标</td><td>样本</td><td>样本量</td><td>最大值</td><td>最小值</td><td>均值</td><td>标准差</td><td>偏度</td><td>峰度</td></tr><tr><td rowspan="3">无风险利率</td><td>ICBCid</td><td>2418</td><td>0.0094</td><td>0.0041</td><td>0.0062</td><td>0.0020</td><td>0.1479</td><td>-1.5874</td></tr><tr><td>CCB</td><td>2420</td><td>0.0094</td><td>0.0041</td><td>0.0062</td><td>0.0020</td><td>0.1481</td><td>-1.5863</td></tr><tr><td>BOCid</td><td>2419</td><td>0.0094</td><td>0.0041</td><td>0.0062</td><td>0.0029</td><td>0.1481</td><td>-1.5871</td></tr><tr><td rowspan="3">ILLIQ</td><td>ICBC</td><td>2418</td><td>0.0216</td><td>0</td><td>0.0021</td><td>0.0024</td><td>2.4445</td><td>8.7416</td></tr><tr><td>CCB</td><td>2420</td><td>0.0453</td><td>0</td><td>0.0033</td><td>0.0040</td><td>2.8830</td><td>13.7516</td></tr><tr><td>BOCid</td><td>2419</td><td>0.0457</td><td>0</td><td>0.0041</td><td>0.0055</td><td>2.3714</td><td>7.2197</td></tr></table>

价系数 $\beta$ 两个指标进行经济学和金融学解释。

(1)市场Amihud指标(AILLIQ)

市场Amihud指标(AILLIQ)"4衡量的是整个股市的流动性，其计算方法为：

$$
A I L I Q _ { y } = \frac { 1 } { N _ { y } } { \sum _ { t = 1 } ^ { N _ { y } } } I L L I Q _ { i y }
$$

其中， $N _ { y }$ 是第 $y$ 年股市中的股票数量。

(2)中国股票市场风险评价系数 $\beta$

中国股票市场风险评价系数 $\beta$ 反映的是证券系统性风险的指标，通常用来衡量一种证券相对于整个股市的波动程度。其计算方式为：

$$
\begin{array} { l } { r _ { i t } = \alpha _ { i } + \beta _ { i } r _ { m t } + \varepsilon _ { i t } } \\ { \displaystyle \hat { \beta } _ { i } = \frac { \displaystyle \sum _ { t = 1 } ^ { T } ( r _ { i t } - \bar { r } _ { i t } ) ( r _ { m t } - \bar { r } _ { m t } ) } { \displaystyle \sum _ { t = 1 } ^ { T } ( r _ { m t } - \bar { r } _ { i t } ) ^ { 2 } } } \end{array}
$$

其中， $r _ { i t }$ 为第 $i$ 支股票在时间 $t$ 的收益率， $r _ { m t }$ 为在时间 $t$ 的市场收益率，样本 $T$ 采用50个交易日的数据。

市场Amihud指标(ALLIQ)和中国股票市场风险评价系数 $\beta$ 的描述性统计分析见表3。

表3市场 Amihud指标(ALLIQ)和风险评价系数 Beta 的描述性统计分析  

<table><tr><td>指标</td><td>样本</td><td>样本量</td><td>最大值</td><td>最小值</td><td>均值</td><td>标准差</td><td>偏度</td><td>峰度</td></tr><tr><td rowspan="3">AILIQ</td><td>ICBC</td><td>2418</td><td>0.5811</td><td>0.0050</td><td>0.0423</td><td>0.0363</td><td>3.5883</td><td>27.7606</td></tr><tr><td>CCB</td><td>2420</td><td>0.5811</td><td>0.0050</td><td>0.0423</td><td>0.0361</td><td>5.5980</td><td>28.2500</td></tr><tr><td>BOC</td><td>2419</td><td>0.5811</td><td>0.0050</td><td>0.0423</td><td>0.0363</td><td>3.5962</td><td>27.8739</td></tr><tr><td rowspan="4">Betaval</td><td>ICBC</td><td>2418</td><td>1.2912</td><td>-0.4693</td><td>0.5444</td><td>0.2638</td><td>−0.0518</td><td>1.0888</td></tr><tr><td>CCB</td><td>2420</td><td>1.6273</td><td>-0.4612</td><td>0.6675</td><td>0.2789</td><td>0.2231</td><td>1.8895</td></tr><tr><td>BOC</td><td>2419</td><td>1.5395</td><td>-0.1604</td><td>0.5764</td><td>0.2327</td><td>1.0014</td><td>3.3265</td></tr><tr><td>ICBC</td><td>2418</td><td>1.3131</td><td>-0.8786</td><td>0.4297</td><td>0.3054</td><td>-0.4116</td><td>1.8190</td></tr><tr><td rowspan="3">Betavals</td><td>CCB</td><td>2420</td><td>1.4764</td><td>-0.9406</td><td>0.5446</td><td>0.3115</td><td>-0.4318</td><td>2.6691</td></tr><tr><td>BOC</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td>2419</td><td>1.5886</td><td>-0.3848</td><td>0.4661</td><td>0.2602</td><td>0.7645</td><td>4.3590</td></tr></table>

注：Betaval为分市场日Beta值：对股票采用各自股票市场的回报率为市场回报率。Betavals为综合市场日Beta值：对所有股票都选取沪深市场综合回报率为市场回报率。

# 3.2以收盘价为一元时间序列的股价预测分析

根据下页图1对三家银行收盘价序列进行滚动样本预测，从而验证模型的预测有效性，并为设置多元序列的深度学习模型参数提供参考。在混合循环神经网络的参数设定上：网络结构1、网络结构2和网络结构3各有30个神经元;损失函数选取Adam 函数；优化器选择RMSProp。滚动窗口期为30天，即将样本序列分割成30天的收盘价为一组序列预测下一天的股价。通过随机抽样法抽取滚动样本预测值与误差值进行误差分析对比不同架构模型的长期预测有效性。

从下页图4和表4可知：在中国工商银行股价序列预

# 财经纵横

测上，滚动预测误差整体最小的网络结构为LSTM-LSTM-GRU结构，预测误差分别为0.0934（MAE）、0.1810（RMSE），1.4565（MAPE）、1.4822(SMAPE);在中国建设银行股价序列预测上，滚动预测误差整体最小的网络结构为LSTM-LSTM-GRU结构，预测误差分别为0.1733(MAE)、0.3279(RMSE)、2.1144(MAPE)、2.1782(SMAPE);在中国银行股价序列预测上，滚动预测误差整体最小的网络结构为GRU-GRU-GRU结构，预测误差分别为0.0309(MAE), 0.0467(RMSE)、0.7899(MAPE)、0.7910(SMAPE)。

从一元时间序列（收盘价）序列的预测结果来看，本文构建的混合循环神经网络结构模型能够针对不同的股票选择最优的预测网络模型结构，相较于以往单一架构的LSTM-LSTM-LSTM模型[10."能够获得更小的预测误差。

# 3.3多元时间序列股价预测分析

鉴于基于技术分析指标和基本面分析指标组成的多元时间序列的结构复杂性，本文将网络结构1、网络结构2和网络结构3的神经元设置为60个。Epoch设定准则、深度学习模型的损失函数和优化器的选择与一元时间序列预测模型相同。滚动窗口期设为120天，通过随机抽样法抽取滚动样本预测值与真实值进行误差分析对比不同架构模型的长期预测有效性。

![](images/4344427ee8082a07065ddf536d0ddd7f1b212042bdfade010dc055b4aae58e91.jpg)  
图4一元时间序列（收盘价序列）滚动预测结果（滚动窗口期 $\scriptstyle = 3 0$ 天）

表4 一元时间序列(收盘价序列)滚动预测误差分析  

<table><tr><td>网络结构1-网络结构2 -网络结构3</td><td>样本</td><td>MAE</td><td>RMSE</td><td>MAPE</td><td>SMAPE</td></tr><tr><td rowspan="2">LSTM-LSTM-LSTM</td><td>ICBC</td><td>0.1025</td><td>0.1977</td><td>1.5906</td><td>1.6233</td></tr><tr><td>CCB</td><td>0.2243</td><td>0.4022</td><td>2.7356</td><td>2.8395</td></tr><tr><td rowspan="2"></td><td>BOC</td><td>0.0311</td><td>0.0464</td><td>0.7947</td><td>0.7956</td></tr><tr><td>ICBC</td><td>0.1051</td><td>0.2046</td><td>1.6233</td><td>1.6594</td></tr><tr><td rowspan="2">LSTM-GRU-LSTM</td><td>CCB</td><td>0.2104</td><td>0.3996</td><td>2.5489</td><td>2.6484</td></tr><tr><td>BOC</td><td>0.0313</td><td>0.0470</td><td>0.7997</td><td>0.7997</td></tr><tr><td rowspan="3">LSTM-LSTM-GRU</td><td>ICBC</td><td>0.0934</td><td>0.1810</td><td>1.4565</td><td>1.4822</td></tr><tr><td>CCB</td><td>0.1733</td><td>0.3279</td><td>2.1144</td><td>2.1782</td></tr><tr><td>BOC</td><td>0.0312</td><td>0.0471</td><td>0.7959</td><td>0.7966</td></tr><tr><td rowspan="3">LSTM-GRU-GRU</td><td>ICBC</td><td>0.0969</td><td>0.1883</td><td>1.5056</td><td>1.5344</td></tr><tr><td>CCB</td><td>0.0969</td><td>0.1883</td><td>1.5056</td><td>1.5344</td></tr><tr><td>BOC</td><td>0.0313</td><td>0.0468</td><td>0.7977</td><td>0.7989</td></tr><tr><td rowspan="3">GRU-LSTM-LSTM</td><td>ICBC</td><td>0.1077</td><td>0.2124</td><td>1.6622</td><td>1.6982</td></tr><tr><td>CCB</td><td>0.2047</td><td>0.3958</td><td>2.4775</td><td>2.5732</td></tr><tr><td>BOC</td><td>0.0312</td><td>0.0471</td><td>0.7977</td><td>0.7981</td></tr><tr><td rowspan="3">GRU-GRU-LSTM</td><td>ICBC</td><td>0.1077</td><td>0.2124</td><td>1.6622</td><td>1.6982</td></tr><tr><td>CCB</td><td>0.2047</td><td>0.3958</td><td>2.4775</td><td>2.5732</td></tr><tr><td>BOC</td><td>0.0312</td><td>0.0471</td><td>0.7977</td><td>0.7981</td></tr><tr><td rowspan="3">GRU-LSTM-GRU</td><td>ICBC</td><td>0.0984</td><td>0.1864</td><td>1.5348</td><td>1.5605</td></tr><tr><td>CCB</td><td>0.2126</td><td>0.3976</td><td>2.5789</td><td>2.6780</td></tr><tr><td>BOC</td><td>0.0312</td><td>0.0471</td><td>0.7963</td><td>0.7967</td></tr><tr><td rowspan="3">GRU-GRU-GRU</td><td>ICBC</td><td>0.0977</td><td>0.1838</td><td>1.5164</td><td>1.5460</td></tr><tr><td>CCB</td><td>0.1834</td><td>0.3425</td><td>2.2363</td><td>2.3060</td></tr><tr><td>BOC</td><td>0.0309</td><td>0.0467</td><td>0.7899</td><td>0.7910</td></tr></table>

从下页图5和表5来看：在结合技术分析和基本面分析指标组成的多元时间序列进行预测后，相应最优的神经网络结构发生了变化。在中国工商银行股价预测上，LSTM-LSTM-LSTM结构[10,"的深度学习模型具有最小的预测误差，分别为0.3864（MAE）、0.4910（RMSE）、5.4932(MAPE）、5.6974(SMAPE)；然而，在中国建设银行股价预测上，基于混合循环神经网络的LSTM-GRU-GRU架构模型能够获得更小的预测误差，分别为0.1910(MAE）、0.2349（RMSE）、3.4498（MAPE）、3.4625（SMAPE）;在中国银行股价预测上，GRU-GRU-LSTM结构的深度学习模型则具有最小的预测误差，分别为0.1125（MAE）、0.1407(RMSE)、3.0645(MAPE)、3.0757(SMAPE)。

从下页图5可看出，混合架构的深度学习模型在股票预测方面能够结合各自的数据特征给出最优的网络模型结构，且相较于以往研究模型能够获得更小的预测误差。

# 4结论

本文基于技术分析、基本面分析和深度学习构建股价预测模型，通过实证分析得出如下结论：一是通过实证分析发现，本文构建的混合循环神经网络的深度学习模型能

# 财经纵横

![](images/95ae3cce33e08b2b5fcba0b87e107d302cc4ee3a2f527de6474079309739790e.jpg)  
图5多元时间序列滚动预测结果(滚动窗口期=120天)

够结合不同的个股数据特征给出最优的网络结构，且相较于以往研究模型能够获得更小的预测误差。二是在将基本面分析指标引入预测模型输入值后，本文构建的混合循环神经网络模型在实证分析中依然能够在股价预测上获得较好的预测效果。综合考虑股价波动的非系统性风险和系统性风险因素指标是金融大数据时代的必然要求，本文实证研究对于未来运用深度学习技术进行股价预测研究的指标选取方面具有重要指导作用。

# 参考文献：

[1]王芳,王宣艺,陈硕.经济学研究中的机器学习:回顾与展望[J].数量经济技术经济研究,2020,37(4).  
[2]Engle R F, Gonzalo R J. The Spline-GARCH Model for Low–frequen-cy Volatility and Its Global Macroeconomic Causes [J].The Review ofFinancial Studies,2008,21(3).  
[3]Huang C L, Tsai C Y. A Hybrid SOFM–SVR With a Filter-based Fea-ture Selection for Stock Market Forecasting [J].Expert Systems WithApplications,2009,36(2).  
[4]徐国祥,杨振建.PCA-GA-SVM模型的构建及应用研究——沪深300指数预测精度实证分析[J].数量经济技术经济研究,2011,28(2).  
[5]林育曼,文海宁，饶浩.基于ARIMA-BP神经网络模型的微信舆情热度预测[J].统计与决策,2019,(14).  
[6]涂锦,冷正兴,刘丁毅.基于EMD和神经网络的非线性时间序列预测方法[J].统计与决策,2020,(8).  
[7]熊志斌.ARIMA融合神经网络的人民币汇率预测模型研究[J].数量经济技术经济研究,2011,28(6).  
[8]张贵生，张信东.基于近邻互信息的SVM-GARCH股票价格预测模型研究[J].中国管理科学,2016,24(9).  
[9]Buyuksahin U C, Ertekina S. Improving Forecasting Accuracy of TimeSeries Data Using a New ARIMA–ANN Hybrid Method and Empiri-cal Mode Decomposition [J].Neurocomputing,2019,(361).  
[10]杨青，王晨蔚.基于深度学习LSTM神经网络的全球股票指数预测研究[J].统计研究,2019,36(3).  
[11]欧阳红兵,黄亢,闫洪举.基于LSTM神经网络的金融时间序列预测[J].中国管理科学,2020,28(4).  
[12]Henrique B M, Sobreiro V A, Kimura H. Literature Review: MachineLearning Techniques Applied to Financial Market Prediction [J].Ex-pert Systems With Applications,2019,(124).  
[13]Yu L, Chen H, Wang S, et al. Evolving Least Squares Support VectorMachines for Stock Market Trend Mining [J].IEEE Transaction onEvolutionary Computation,2009, 13(1).  
[14]Amihud Y. Illiquidity and Stock Returns: Cross-section andTime-series Effects [J].Journal of Financial Markets,2002,(5).

表5  
多元时间序列滚动预测误差分；  

<table><tr><td rowspan=1 colspan=6>衣了               罗元时同序列滚动顶测误差力析</td></tr><tr><td rowspan=1 colspan=1>网络结构1-网络结构2-网络结构3</td><td rowspan=1 colspan=1>样本</td><td rowspan=1 colspan=1>MAE</td><td rowspan=1 colspan=1>RMSE</td><td rowspan=1 colspan=1>MAPE</td><td rowspan=1 colspan=1>SMAPE</td></tr><tr><td rowspan=2 colspan=1>LSTM-LSTM-LSTM</td><td rowspan=2 colspan=1>ICBCCCBBOC</td><td rowspan=2 colspan=1>0.29160.38640.1450</td><td rowspan=1 colspan=1>0.36310.4910</td><td rowspan=2 colspan=1>5.17715.49323.8974</td><td rowspan=2 colspan=1>5.38885.69743.9583</td></tr><tr><td rowspan=1 colspan=1>0.1742</td></tr><tr><td rowspan=3 colspan=1>LSTM-GRU-LSTM</td><td rowspan=3 colspan=1>ICBCCCBBOC</td><td rowspan=1 colspan=1>0.3113</td><td rowspan=1 colspan=1>0.3922</td><td rowspan=1 colspan=1>5.5218</td><td rowspan=1 colspan=1>5.7702</td></tr><tr><td rowspan=1 colspan=1>0.6087</td><td rowspan=1 colspan=1>0.6909</td><td rowspan=1 colspan=1>8.6546</td><td rowspan=1 colspan=1>9.1546</td></tr><tr><td rowspan=1 colspan=1>0.1280</td><td rowspan=1 colspan=1>0.1588</td><td rowspan=1 colspan=1>3.4927</td><td rowspan=1 colspan=1>3.4702</td></tr><tr><td rowspan=3 colspan=1>LSTM-LSTM-GRU</td><td rowspan=2 colspan=1>ICBCCCB</td><td rowspan=1 colspan=1>0.3649</td><td rowspan=1 colspan=1>0.4321</td><td rowspan=1 colspan=1>6.5309</td><td rowspan=1 colspan=1>6.8429</td></tr><tr><td rowspan=1 colspan=1>0.4245</td><td rowspan=1 colspan=1>0.5311</td><td rowspan=1 colspan=1>6.0047</td><td rowspan=1 colspan=1>6.2703</td></tr><tr><td rowspan=1 colspan=1>BOC</td><td rowspan=1 colspan=1>0.1550</td><td rowspan=1 colspan=1>0.1910</td><td rowspan=1 colspan=1>4.1536</td><td rowspan=1 colspan=1>4.2400</td></tr><tr><td rowspan=3 colspan=1>LSTM-GRU-GRU</td><td rowspan=2 colspan=1>ICBCCCB</td><td rowspan=1 colspan=1>0.1910</td><td rowspan=1 colspan=1>0.2349</td><td rowspan=1 colspan=1>3.4498</td><td rowspan=1 colspan=1>3.4625</td></tr><tr><td rowspan=1 colspan=1>0.4926</td><td rowspan=1 colspan=1>0.5914</td><td rowspan=1 colspan=1>6.9694</td><td rowspan=1 colspan=1>7.3195</td></tr><tr><td rowspan=1 colspan=1>BOC</td><td rowspan=1 colspan=1>0.1154</td><td rowspan=1 colspan=1>0.1576</td><td rowspan=1 colspan=1>3.0843</td><td rowspan=1 colspan=1>3.1626</td></tr><tr><td rowspan=3 colspan=1>GRU-LSTM-LSTM</td><td rowspan=3 colspan=1>ICBCCCBBOC</td><td rowspan=1 colspan=1>1.0033</td><td rowspan=1 colspan=1>1.0376</td><td rowspan=1 colspan=1>18.0397</td><td rowspan=3 colspan=1>19.949910.85154.9871</td></tr><tr><td rowspan=1 colspan=1>0.7064</td><td rowspan=1 colspan=1>0.8092</td><td rowspan=1 colspan=1>10.1287</td></tr><tr><td rowspan=1 colspan=1>0.1844</td><td rowspan=1 colspan=1>0.2154</td><td rowspan=1 colspan=1>5.0489</td></tr><tr><td rowspan=3 colspan=1>GRU-GRU-LSTM</td><td rowspan=2 colspan=1>ICBCCCB</td><td rowspan=2 colspan=1>0.67920.5559</td><td rowspan=1 colspan=1>0.7221</td><td rowspan=1 colspan=1>12.1855</td><td rowspan=1 colspan=1>13.0793</td></tr><tr><td rowspan=1 colspan=1>0.6480</td><td rowspan=1 colspan=1>7.9350</td><td rowspan=1 colspan=1>8.3582</td></tr><tr><td rowspan=1 colspan=1>BOC</td><td rowspan=1 colspan=1>0.1125</td><td rowspan=1 colspan=1>0.1407</td><td rowspan=1 colspan=1>3.0645</td><td rowspan=1 colspan=1>3.0757</td></tr><tr><td rowspan=3 colspan=1>GRU-LSTM-GRU</td><td rowspan=3 colspan=1>ICBCCCBBOC</td><td rowspan=2 colspan=1>0.44450.7132</td><td rowspan=1 colspan=1>0.4939</td><td rowspan=1 colspan=1>7.9809</td><td rowspan=1 colspan=1>8.3895</td></tr><tr><td rowspan=1 colspan=1>0.7963</td><td rowspan=1 colspan=1>10.1706</td><td rowspan=2 colspan=1>10.85005.3990</td></tr><tr><td rowspan=1 colspan=1>0.1987</td><td rowspan=1 colspan=1>0.2304</td><td rowspan=1 colspan=1>5.4609</td></tr><tr><td rowspan=3 colspan=1>GRU-GRU-GRU</td><td rowspan=1 colspan=1>ICBC</td><td rowspan=1 colspan=1>0.2584</td><td rowspan=1 colspan=1>0.3071</td><td rowspan=1 colspan=1>4.598</td><td rowspan=1 colspan=1>4.7375</td></tr><tr><td rowspan=1 colspan=1>CCB</td><td rowspan=1 colspan=1>0.7661</td><td rowspan=1 colspan=1>0.8390</td><td rowspan=1 colspan=1>10.9318</td><td rowspan=1 colspan=1>11.6844</td></tr><tr><td rowspan=1 colspan=1>BOC</td><td rowspan=1 colspan=1>0.2230</td><td rowspan=1 colspan=1>0.2642</td><td rowspan=1 colspan=1>6.0160</td><td rowspan=1 colspan=1>6.1287</td></tr></table>

(责任编辑/谢雅倩)