# Universal scaling and nonlinearity of aggregate price impact in financial markets

Felix Patzelt1, 2, ∗ and Jean-Philippe Bouchaud $^ { 1 , 3 }$ $^ { 1 }$ Capital Fund Management, 23 rue de l’Universit´e, 75007, Paris, France $^ 2$ Supported by Deutsche Forschungsgemeinschaft $^ 3$ Ecole Polytechnique, 91120 Palaiseau, France

How and why stock prices move is a centuries-old question still not answered conclusively. More recently, attention shifted to higher frequencies, where trades are processed piecewise across different timescales. Here we reveal that price impact has a universal non-linear shape for trades aggregated on any intra-day scale. Its shape varies little across instruments, but drastically different master curves are obtained for order volume and -sign impact. The scaling is largely determined by the relevant Hurst exponents. We further show that extreme order flow imbalance is not associated with large returns. To the contrary, it is observed when the price is “pinned” to a particular level. Prices move only when there is sufficient balance in the local order flow. In fact, the probability that a trade changes the mid-price falls to zero with increasing (absolute) order-sign bias along an arc-shaped curve for all intra-day scales. Our findings challenge the widespread assumption of linear aggregate impact. They imply that market dynamics on all intra-day timescales are shaped by correlations and bilateral adaptation in the flows of liquidity provision and taking.

# CONTENTS

I. Introduction 1

II. The Data 2

III. Results

A. Aggregate Impact B. Scaling & Hurst Exponents C. Large Order Imbalances & Pinned Prices

IV. Discussion

6   
Acknowledgments 8   
References 8   
Appendices 9   
A. Single trade impacts 9   
B. Impact curves for 30 instruments 9   
C. Change probability curves for 30 instruments 10

# I. INTRODUCTION

Markets allow different sources of information to be processed and transformed into a single number: the price. Since these market prices in turn play an important signalling role for the rest of the economy, the efficiency of the price formation process is a highly relevant question. Equilibrium models explain some general features of asset prices in a formally elegant way without considering the detailed price formation process [1–3].

There is, however, growing evidence that financial markets are almost never in equilibrium and that prices reflect more than fundamental information [4–7]. Instead, the flow of demand and supply, information and opinions is only slowly digested, one transaction at a time [8]. Understanding such dynamics is of great importance for practitioners optimising their trading strategies, as well as for exchanges and regulators interested in improving market efficiency and stability.

In modern electronic markets, participants interact through a limit order book (LOB) in a continuous double-auction. Some market participants act as liquidity providers by placing limit orders (buy or sell) in the LOB. Other market participants act as liquidity takers: they need to execute their trades immediately, and correspondingly trigger transactions by sending market orders. These market orders tend to impact prices: statistically, a buy (resp. sell) market order pushes the price upwards (resp. downwards).

While the average price impact of single market orders is relatively well understood, the impact of a series of market orders is much more complex. For example, a perplexing empirical result is the square-root volume dependence of the impact of a metaorder, i.e., a sequence of individual orders belonging to the same trading decision that cannot be executed in a single transaction but must instead be fragmented (see e.g. [8, 9] and refs. therein)1. This result is at odds with, e.g., the classical Kyle model of impact which predicts a linear dependence on volume [11]. The empirical analysis of metaorders is difficult since it requires a proprietary database, where the trades belonging to a given trading decision can be identified. When such data is available, the square-root impact law seems to be universally vindicated, for a wide variety of markets, epochs and trading styles.

Most available datasets are, however, anonymized: while the sign $\epsilon$ and volume $v$ of each market order can be reconstructed (see section II), the identity of the trader (or of the trading institution) at the origin of the market order is usually unknown. One can nevertheless define the aggregate impact $\mathcal { R } _ { N }$ over $N$ consecutive trades as the average price return, conditioned to a certain total volume imbalance $\mathcal Q _ { N }$ defined as:

$$
\mathcal { Q } _ { N } = \sum _ { i = 1 } ^ { N } q _ { i } , \qquad q _ { i } : = \epsilon _ { i } v _ { i } ,
$$

where $q _ { i }$ is the signed volume of the $i ^ { \mathrm { t h } }$ trade (see Eq. 2 below for complete definitions). Although the impact of a single trade is well known to be a strongly concave function of its volume, it is reported that the aggregate impact of $N$ trades becomes linear in $\mathcal { Q }$ as $N$ increases [8, 12].

This picture, however, is quite incomplete as we reveal in this empirical paper. We show that once correctly rescaled, and for $N \gtrsim 1 0$ , the aggregate impact function exhibits a non-linear, sigmoidal shape that is approximately independent of the number of transactions $N$ and of the chosen asset (large tick stocks, small tick stocks, futures).

We also study the aggregate-sign impact, where the conditioning variable is not $\mathcal Q _ { N }$ but rather the sign imbalance $\begin{array} { r } { \mathcal { E } _ { N } = \sum _ { i = 1 } ^ { N } \epsilon _ { i } } \end{array}$ . Scaling is again observed in this case, now with an impact function that reverts back to zero at both extremes.

After quantifying the rescaling of the aggregate impact curves over different time-horizons, we investigate why the price-impact for extreme order-sign imbalances reverts towards zero. We find that the local bias of the order signs and the probability that an order changes the price compensate each other to a very high degree. Although possibly anticipated on general grounds, this effect does not seem to have been quantitatively reported so far, and has very fundamental and important consequences on the dynamics of markets.

The present paper is mostly about empirical observations. The ability of currently available models to describe quantitatively the scaling properties of the nonlinear aggregate impact curves will be the topic of a companion paper [13].

# II. THE DATA

Our dataset contains the highest turnover instruments on three different platforms, namely:

• 12 technology stocks on the US primary NASDAQ market, for the years 2011 to 2016. This includes some of the most traded stocks in the world like Apple (AAPL) and Microsoft (MSFT).

the 13 highest turnover stocks on NASDAQ OMX NORDIC (called just OMX in the following), which covers the Nordic markets Stockholm, Helsinki, and Copenhagen for October 2011 until end of September 2015. OMX is the primary market for the selected stocks.

6 futures on EUREX EBS (BOBL, BUND, DAX, EUROSTOXX, SCHATZ, SMI) for October 2014 until the end of 2015.

We chose to analyse three different platforms in order to have some variability in terms of market microstructure in the sample while keeping the complexity of the data preparation manageable. The instruments were selected for their high turnover, reasonable concentration on their primary markets, quality of the data, and availability via the same provider for the entire period that was analysed: WOMBAT for NASDAQ, NOMURA for OMX, and the exchange itself for the EUREX data.

The NASDAQ stocks are also traded on different USmarkets and trades are routed automatically to the best offer. Nevertheless, we chose to not aggregate several US-markets, because they are frequently desynchronised at the millisecond scale [14, 15], leading to inconsistent aggregate bid- and ask-prices, that is, the best visible buy and sell limit orders, respectively, as reported by the market just before each transaction is executed. We found that the microstructural parameter $\eta \in [ 0 , 1 ]$ appears to be a good measure of the importance of pricediscretisation.2 Prices on NASDAQ are discretised with a fixed tick-size of $\$ 0.01$ , which can be considered very small ( $\eta = 0 . 7 3$ ) to medium ( $\eta = 0 . 4 9$ ) for the analysed stocks. Up to roughly one third of the transactions were executed against hidden liquidity.

Stocks on OMX are only traded on one of the Nordic markets at a time, and much less fragmented than US stocks. Tick-sizes vary with price and are effectively larger ( $0 . 2 4 \leq \eta \leq 0 . 5 0$ ) than for NASDAQ. Here, hidden liquidity represents a vanishingly small fraction of all traded volume and seems to be concentrated on the mid. Finally, the EUREX futures are not traded on other platforms at all. Tick-sizes vary considerably between moderately large ( $\eta = 0 . 4 4$ ) and extremely large ( $\eta = 0 . 0 3$ ).

In the following, we calculate price-returns $r _ { t } = $ $\log m _ { t + 1 } - \log m _ { t }$ from the mid-prices $m$ defined as the average of the bid-price and the ask-price just before each transaction.

We constructed order-signs by labelling all trades above the mid-price as $\epsilon \ = \ + 1$ and all trades below as $\epsilon = - 1$ . Trades exactly at the mid-price were discarded. We decided not to use the signs provided by the exchanges themselves because hidden liquidity is not correctly labeled on NASDAQ for a part of the analysed period. Nevertheless, we confirmed all the following results using the exchange-provided signs, with only very minor quantitative differences. Trade-ids were only available from EUREX. Therefore, we merged all transactions based on the timestamps, which were reported with millisecond precision for all three platforms (see also appendix A).

Trading volumes vary considerably over time. To control for extremely active days, we normalised aggregate transaction volumes $\mathcal { Q } = \langle Q _ { D } \rangle / Q _ { D } \sum _ { i } q _ { i }$ by the daily volume $Q _ { D }$ relative to its average. This global normalisation will be omitted in the following equations for notational simplicity.

The first 30 minutes after opening and before closing on each day are discarded, as well as all days with shortened trading-hours. Obviously irregular entries were discarded too, such as transactions labelled as irregular by the exchange or provider, transactions outside the aforementioned hours, or transactions with non-finite prices (including bid- and ask-prices).

# III. RESULTS

# A. Aggregate Impact

As mentioned in the introduction, we measure the aggregate-volume impact as

$$
\mathcal { R } _ { N } ( \mathcal { Q } ) : = \left. \log m _ { t + N } - \log m _ { t } \Big | \mathcal { Q } = \sum _ { i = 0 } ^ { N - 1 } q _ { t + i } \right. ,
$$

where $m _ { t }$ is the mid-price immediately before the $t ^ { \mathrm { t h } }$ transaction, the signed volume of the $t ^ { \mathrm { t h } }$ transaction $q _ { t }$   
and $\langle \dots \rangle$ denotes an empirical average over all time windows containing $N$ successive trades, executed the same day. $\mathcal { R } _ { 1 } ( \mathcal { Q } )$ corresponds to the average impact of a single market order of signed volume $\mathcal { Q }$ as studied in, e.g., [8, 17].

As expected, both width and height of the function $\mathcal { R } _ { N } ( \mathcal { Q } )$ increase with $N$ . However, if one rescales the $\mathcal { Q }$ -axis with an $N$ -dependent volume scale $Q _ { N }$ , and the $\mathcal { R }$ -axis with an $N$ -dependent return scale $R _ { N }$ , all curves for $N \gtrsim 1 0$ collapse to a single master curve, as shown in ∼Figure 1 for AAPL, and in Appendix B for a variety of other assets. More precisely, one finds that empirically:

$$
\mathcal { R } _ { N } ( \mathcal { Q } ) \approx R _ { N } \mathcal { F } \left( \frac { \mathcal { Q } } { Q _ { N } } \right) ,
$$

where $Q _ { N }$ and $R _ { N }$ both obey power-law scaling with $N$ ,

$$
\begin{array} { r } { Q _ { N } \approx Q _ { 1 } N ^ { \xi } , } \\ { R _ { N } \approx R _ { 1 } N ^ { \psi } , } \end{array}
$$

and the scaling function ${ \mathcal { F } } ( x )$ is a sigmoidal function parameterized as

$$
{ \mathcal { F } } ( x ) = { \frac { x } { ( 1 + | x | ^ { \alpha } ) ^ { \beta / \alpha } } } ,
$$

where $\alpha$ and $\beta$ are fitting parameters that describe the shape of ${ \mathcal { F } } ( x )$ . Note that for $x  0$ , the leading behaviour is:

$$
{ \mathcal { F } } ( x ) = x - { \frac { \beta } { \alpha } } \mathrm { s i g n } ( x ) | x | ^ { 1 + \alpha } + \ldots ,
$$

i.e., a linear behaviour with possibly non-analytic corrections.

For $x \to \infty$ , on the other hand, one has:

$$
\mathcal { F } ( x ) = \mathrm { s i g n } ( x ) | x | ^ { 1 - \beta } + . . . .
$$

Hence $\beta = 1$ corresponds to saturation for large volumes, $\beta < 1$ to continued growth, and $\beta > 1$ to reversal towards lower impacts.

In order to determine the rescaling exponents $\xi$ and $\psi$ , the shape of $\mathcal { R } _ { N } ( Q )$ is fitted for each $N$ using the scaling form Eq. (3) with ${ \mathcal { F } } ( x )$ given by Eq. (6), keeping the same value of $\alpha$ and $\beta$ for all $N$ . 3 We obtained $\alpha = 1 . 2 \pm$ 0.6, $\beta = 1 . 3 \pm 0 . 7$ for the mean and standard deviation of the fitted $\mathcal { R } _ { N } ( Q )$ across all instruments in the sample. The corresponding scaling function for AAPL is shown as a dashed line in Fig. 1.4

Once ${ \mathcal { F } } ( x )$ is fixed, one can map out the scale factors $Q _ { N }$ and $R _ { N }$ as a function of $N$ , which are described very accurately by power-laws of $N$ as shown in Fig. 2.5 The final rescaled impact functions are shown in Fig. 7 of Appendix B for other stocks and futures. All scaling curves look remarkably similar, as indicated by the similar values of $\alpha$ and $\beta$ in all cases. Any theoretical approach will have to explain not only the value of the exponents $\xi$ and $\psi$ , but also of the full master curve ${ \mathcal { F } } ( x )$ .

Together with the rescaled aggregate-volume impact, Fig. 1 shows the corresponding cumulative distribution of volume, rescaled by $Q _ { N }$ . Events far in the saturation regime occur with probability $\sim 1 0 ^ { - 2 }$ on a daily basis. This must be compared with the typical number of trades per day, which is of the order of $1 0 ^ { 4 }$ for AAPL. For example, there about 100 events per day at the end of a bin of size $N = 1 0 0$ and within the saturation regime. Events contributing to the saturation regime are relatively frequent, and the effect is therefore not anecdotal.

![](images/c9cbd3b628fffd3614ff999a4b80cca31bd1b767218f0d8f97b5912dcdfb3f1b.jpg)  
FIG. 1. AAPL on NASDAQ in 2016. Upper row, left: rescaled expected return $\mathcal { R } _ { N } ( \mathcal { Q } / N ^ { \xi } ) / N ^ { \psi }$ conditioned of the volume imbalance $\mathcal { Q }$ for different bin sizes $N$ in arbitrary units (see eqns. 2, ff.). X- and y-axis rescaling exponents: $\xi = 0 . 8 4$ , $\psi = 0 . 5 3$ . Right: rescaled mean return $\mathcal { R } _ { N } ( \mathcal { E } / N ^ { \psi } ) / N ^ { \psi }$ conditioned on the sign imbalance $\varepsilon$ (see eq. 9). $\xi _ { \epsilon } = 0 . 6 9$ , $\psi _ { \epsilon } = 0 . 4 8$ . Lower row: the corresponding complementary cumulative distributions. The positive and negative half were calculated independently and then binned to smooth out noise and discretisation steps for small $N$ . The largest shown $N$ corresponds to the shortest day in the sample.

The right-hand panel of Fig. 1 shows the rescaled aggregate-sign impact, defined as:

the order-signs is associated to a very small price change on average. This effect is found for all instruments, and also for the trade imbalance, as shown in Figures 8 and 9 in Appendix B. The reason for this highly peculiar behaviour is investigated below. First, however, we have a closer look at the scaling exponents $\xi$ and $\psi$ (and their counterpart for the aggregate-sign impact $\xi _ { \epsilon }$ and $\psi _ { \epsilon }$ ).

$$
\mathcal { R } _ { N } ( \mathcal { E } ) : = \left. \log m _ { t + N } - \log m _ { t } \Big | \mathcal { E } = \sum _ { i = 0 } ^ { N - 1 } \epsilon _ { t + i } \right. .
$$

Here, the impact for small sign imbalances is more linear than for the volume imbalance, corresponding to a larger value of the effective parameter $\alpha$ . Around a sign imbalance of $5 0 \%$ , the impact saturates sharply and reverts towards zero at the extremes. This may come as a surprise since it means that a very strong imbalance in

# B. Scaling & Hurst Exponents

Figure 3 shows the means and standard deviations for several scaling exponents. The scaling exponent of the width $Q _ { N }$ of the aggregate-volume impact is found close to $\xi \approx 0 . 7 5$ while the exponent governing the height $R _ { N }$ is $\psi \approx 0 . 5$ . In other words, the width of the impact curve grows faster than its height when the bin size is increased. Very similar values are found for the aggregate-sign impacts (exponents $\xi _ { \epsilon }$ and $\psi _ { \epsilon }$ ). Note that using Eqs. (3) and (6), the slope of the linear region of impact follows as $\partial \mathcal { R } _ { N } ( \mathcal { Q } ) / \partial \mathcal { Q } | _ { \mathcal { Q } = 0 } = R _ { N } / Q _ { N }$ . It scales as $N ^ { - \kappa }$ with $\kappa = \xi - \psi \approx 0 . 2 5$ , i.e. it decreases with $N$ as a power-law $N$ .6

![](images/72de7e64a58460ea5008c235c0b7c63521b1658414d958861d7ef52904c562b4.jpg)  
FIG. 2. AAPL in 2016. Top: Volume scales $Q _ { N }$ for the impact curves (see eq. 3) that were fitted to each bin-size for the same data shown in the upper left part of Fig. 1. Solid line: power-law fit used for the rescaling along the volumeimbalance axis. Bottom: The same analysis but for the return scale $R _ { N }$ , i.e. the scaling of the impact curve along the return axis. Note that the preceding fitting of the impact curves, yielding $Q _ { N }$ and $R _ { N }$ for each $N$ , did not impose any assumptions on their scaling. Relative fitting errors are below $1 \%$ , but variability across instruments and periods is much larger (see below).

Since both $\mathcal { R } _ { N }$ and $\mathcal Q _ { N }$ are sums over random variables (resp. returns and signed volumes), one expects that their natural scaling with $N$ is governed by the Hurst exponents of the underlying variables $r$ and $q$ . Here we define the Hurst exponent $H$ of a zero-mean random variable $x$ from the scaling of the standard deviation of sums of $N$ successive events:

$$
\biggl \langle \left( \sum _ { i = 1 } ^ { N } x _ { i } \right) ^ { 2 } \biggr \rangle : = D N ^ { 2 H _ { x } } ,
$$

where $D$ is a constant and where we take advantage of the fact that returns and signed volumes have a zero average over long time-horizons.7 As usual, $H = 0 . 5$ corresponds to regular diffusion, $H < 0 . 5$ to sudiffusion, and $H > 0 . 5$ to superdiffusion.

Returns are almost diffusive with a very slight tendency for mean-reversion (particularly for large-tick instruments). This is consistent with $\psi$ and $\psi _ { \epsilon }$ . Volume signs are only slightly positively correlated, at least when measured through $H _ { q }$ . Order signs are (as is well known) strongly correlated with $H _ { \epsilon } > 0 . 7$ , close to the values of $\xi$ and $\xi _ { \epsilon }$ . This implies that the scales of the aggregate impact curves are mostly determined by the accumulated variation in the return- and sign- time series. Interestingly, the scaling of the impact curves is not trivially related to the Hurst exponent of volume fluctuations, but rather to sign fluctuations. This is expected from the fact that the volume of individual orders exhibits extreme variability that mostly reflects the available liquidity at the best price [18–20]. Large fluctuations of order volumes $\boldsymbol { v }$ introduce an independent source of noise that masks part of the order-sign correlations when measuring $H _ { q }$ in the way described above (see [21] for a related discussion).

On the right-hand panel in Fig. 3, significant cross correlations across instruments between the different scaling exponents are shown.8 We find positive correlations between $\xi$ and $H _ { q }$ as well as between $\psi$ and $H _ { r }$ , offering some reassurance that the similar average values (lefthand pane) are more than a pure coincidence. We also find positive correlations between $\xi _ { \epsilon }$ and $H _ { \epsilon }$ . However, there are no significant correlations between $\psi _ { \epsilon }$ and $H _ { r }$ or between $H _ { \epsilon }$ and $H _ { q }$ . This hints at a quite complex interplay of several factors driving the variability in the different scaling behaviors across instruments. $H _ { \epsilon }$ is negatively correlated with $H _ { r }$ , which implies more ordersplitting on more mean-reverting, larger tick instruments. Remember, though, that $H _ { r }$ only varies very little across instruments (Fig. 3).9,10

# C. Large Order Imbalances & Pinned Prices

As stated before, extreme order-sign imbalance is not associated with large returns. To the contrary, such large imbalances are observed when the price is “pinned” to a particular level. A typical example is shown in Fig. 4. Around trade 9100, a series of more than 100 market sell orders arrives, yet the mid-price only bounces up and down half a tick as liquidity providers replenish limit buy orders at the best price or inside of the spread (the distance between the best bid- and the ask price). Many of these trades are quite small, but some are significantly larger as liquidity takers adapt to the available volume at the best.

![](images/78f3615548fb528af6177a50e208d6364f3977d185f6fe28bbe41640b9eb473a.jpg)  
FIG. 3. Left: Analysis of the distributions of several scaling exponents. Plotted symbols: means. Vertical lines: standard deviations. Both were calculated over instruments, for each of which the exponents were calculated for all 1-year periods before averaging. Blue dots correspond to the scaling of a variable that a price-impact is typically conditioned on, i.e. the with of an impact curve along the $\mathbf { X }$ -axis. Green triangles correspond to the scaling of a variable measuring price changes, i.e. the height along the y-axis. Variables left to right: Volume imbalance and corresponding return rescaling $\xi$ , $\psi$ . Sign imbalance and corresponding return rescaling $\xi _ { \epsilon }$ , $\psi _ { \epsilon }$ . Hurst exponents of the Volume imbalance $H _ { q }$ , returns $H _ { r }$ , order-signs $H _ { \epsilon }$ , and return signs $H _ { \pm }$ (see eq. 10). Right: Cross-correlation calculated over all instruments for the same variables. Only correlations differing from zero by more then 3 std are shown.

The mid-price only diffuses freely when market trades happen on both sides of the book. The upper panel in Fig. 5 shows the probability of a mid-price change between two subsequent trades as a function of the average order sign in the bin, $\bar { \epsilon } : = \mathcal { E } / N$ . One of the central results of this paper is that biased order-signs lead to a lower probability for price changes on any intra-day time scale. Note in particular that the price-change probability has an almost invariant triangular shape for all bin sizes of $N \gtrsim 5 0$ . It approaches zero for highly biased order signs. The qualitative behaviour is the same for smaller $N$ , although the curve is broader and smoother, and has a flatter maximum around $\bar { \epsilon } = 0$ . This behaviour is universal across all instruments (see Appendix C for more examples). The corresponding cumulative distribution is shown in the lower pane, confirming that strong order-sign imbalances happen relatively frequently on a daily basis. The non-intuitive negative correlation between sign imbalance and return is therefore not an artefact due to a lack of data.

# IV. DISCUSSION

We investigated how prices are impacted by the flow of market orders and found a universal behaviour on all intra-day time scales. We have shown that the impact curves, once correctly rescaled, are remarkably stable across time scales (from bins of $N ~ = ~ 1 0$ trades up to an entire day of trading, beyond which overnight effects would have to be taken into a account) and instruments (large & small tick US stocks, Nordic stocks, EUREX futures). This illustrates how measuring master curves instead of either scaling laws for scalar quantities or conditional expectation curves on individual timescales can substantially improve the insights gained on market dynamics. To fully appreciate the master curves’ robustness, we kindly encourage the reader to read the appendices below. Our results suggest that the price formation process in financial markets is the result of some general, universal mechanism. While the latter is still to be elicited, our findings do provide some hints.

We find that the aggregate-volume impact saturates for large (rescaled) imbalances, on all time scales. The behaviour of the aggregate-sign impact is even more striking: highly biased order flows are associated with very small price changes. More precisely, we find that the probability for an order to change the price decreases with the local imbalance, and vanishes when the order signs are locally strongly biased in one direction. At high frequencies, extreme order-sign imbalances occur when a very large volume is available on the opposite side of the order book, resulting in prices being temporarily pinned to a certain level. These large volumes manifest themselves either as visible large limit orders or as repeated refills near a particular price-level.

![](images/74062254cb8c621dc2023dad0d9d9a1e8c1e46001caea489aeb7c7d4b85201fe.jpg)  
FIG. 4. AAPL, May first 2016. An typical example of an extreme order-sign imbalance and a “sticky price”. The visible liquidity at each price-level just before each trade is drawn in red above and in blue below the mid-price (upper solid line). Full saturation corresponds to the 90-percentile for the day. The signed buy volumes $q ^ { + }$ for each trade are drawn as bars above the orderbook reconstruction and the signed sell volumes $q ^ { - }$ below. The volume axis is log-scaled. A lower bound for the true number of trades is shown because transactions with the same sign and timestamp were merged (see section II). Therefore, a series of 100 successive market buys drawn above took at least 100ms in wall time and may have consisted of more than 100 independent market orders submitted to the market. Lower solid curve: 50 trade sign imbalance (causal).

Qualitatively, this dependence of the price-change probabilities on average order signs is consistent with models and empirical results in the literature. For example, the Madhavan-Richardson-Roomans model [22] postulates that the change of price is proportional to the sign “surprise”, i.e. the difference between the sign $\epsilon$ of a market order and its expected value, based on previous signs. When it is extremely likely that the next trade is a buy, and a buy trade indeed materializes, then the price change is small. Empirically, many studies have reported that returns in the direction of a particular trade-sign predictor are on average lower than those in the opposite direction (see e.g. [23–25]). This effect is attributed to liquidity takers adjusting their market order volume at the outstanding liquidity, while liquidity providers revise their limit orders and refill to match the incoming order bias. Our results show a connection to the aggregate price-impact and a direct measure of the aforementioned, hypothesised bilateral order-flow adaptation. The probability of price changes as a function of local sign imbalance becomes (for large $N$ ) a tent-shaped function that has a discontinuous slope for zero imbalance and vanishes for strong imbalances. This observation is consistent with [12] where a similar shape was reported for the standard deviation of price-changes in 15 minute windows for US stocks traded in 1994–1995, i.e. before electronic markets and High-Frequency algorithms.

Taken together, our findings suggest that markets generally operate in a state where traders collectively counorder signs on repeated refills (as shown in Fig. 4) should not come as a surprise: these observation simply confirm that liquidity takers pay attention to the currently available liquidity. Reciprocally, liquidity providers observe the flow of market orders and adapt their behavior to the well-known long-range correlations of order-signs (see [21] for a related discussion).

![](images/1f7a9f6ce4c92d5195f6ec8f124ee54b2fc2bb36d63280287aef186f8c0acbf4.jpg)  
FIG. 5. EUROSTOXX on EUREX in 2015. Upper row: the probability $P ( \mathcal { R } \neq 0 | N ^ { - 1 } \mathcal { E } )$ that the mid-price changes from one trade to the next conditioned on the mean trade sign in the bin containing $N$ trades. Lower row: the corresponding complementary cumulative distributions.

In this scenario, price fluctuations mostly reflect the a lack of predictability, or “surprise” of an event. Dynamics of this type have previously been shown to be capable of generating clustered volatility and extreme pricejumps in stylised multi-agent systems [26] and in highly adaptive control systems in [27]. Therefore, the present work provides a first step towards more directly testable models along these lines, and suggests that the classical notion of market efficiency [28] should be extended to include endogenous information on top of exogeneous news.

In a forthcoming paper [13], we will investigate in detail how accurately the nonlinear master curves and rescaling exponents described above can be reproduced using propagator models [29] and their generalisations [30, 31]. Our results provide important constraints for such models, and for realistic market models in general, since they quantify how the market reacts to both order bias and price-change probability on all intra-day time scales. Naturally, such improved impact models are of interest both for practitioners trying to reduce their trading costs and for regulators trying to understand the stability of markets.

terbalance the impact of predictable events to a very high degree, and on all intra-day timescales. Since marketorder volumes are known to be highly conditioned on visible liquidity (see e.g. [20]), the dependence of market

# ACKNOWLEDGMENTS

This work was inspired by a preliminary unpublished study by Julius Bonart. We thank him, and M. Benzaquen, G. Bormetti, F. Bucci, J. De Lataillade, J. Donier, Z. Eisler, M. Gould, S. Gualdi, S. Hardiman, J. Kockelkoren, F. Lillo, I. Mastromatteo, D. Taranto & B. Toth for many inspiring discussions. We also thank G. Bolton, J. Lafaye, and C.A. Lehalle for support and advice during data preparation.

demand. In Thorsten Hens and Klaus Reiner Schenk-Hoppe, editors, Handbook of Financial Markets: Dynamics and Evolution. North-Holland, Elsevier, 2009. [9] Jonathan Donier, Julius Bonart, Iacopo Mastromatteo, and J-P Bouchaud. A fully consistent, minimal model for non-linear market impact. Quantitative finance, 15(7):1109–1121, 2015.   
[10] Elia Zarinelli, Michele Treccani, J. Doyne Farmer, and Fabrizio Lillo. Beyond the square root: Evidence for logarithmic dependence of market impact on size and participation rate. Market Microstructure and Liquidity, 01(02):1550004, 2015.   
[11] Albert S Kyle. Continuous auctions and insider trading. Econometrica, 53(6):1315–1335, 1985.   
[12] Vasiliki Plerou, Parameswaran Gopikrishnan, Xavier Gabaix, and H Eugene Stanley. Quantifying stock-price response to demand fluctuations. Physical Review $E$ 66(2):027104, 2002.   
[13] Felix Patzelt and Jean-Philippe Bouchaud. Nonlinear price impact from linear models. Preprint arXiv:1706.04163 [q-fin.TR], 2017.   
[14] Phil Mackintosh and Ka Wo Chen. The need for speed iii: Physics and a little trigonometry. KCG Holdings, Inc. https://www.kcg.com/news-perspectives/article/ the-need-for-speed-iii-physics-and-a-little-trig 2016.   
[15] Phil Mackintosh and Ka Wo Chen. The need for speed v: How important is 1 ms? KCG Holdings, Inc. https://www.kcg.com/news-perspectives/article/ the-need-for-speed-v-how-important-is-ms, 5 2016.   
[16] Khalil Dayri and Mathieu Rosenbaum. Large tick assets: implicit spread and optimal tick size. Market Microstructure and Liquidity, 1(01):1550003, 2015.   
[17] Fabrizio Lillo, J Doyne Farmer, and Rosario N Mantegna. Econophysics: Master curve for price-impact function. Nature, 421(6919):129–130, 2003.   
[18] Charles M Jones, Gautam Kaul, and Marc L Lipson. Transactions, volume, and volatility. Review of financial studies, 7(4):631–651, 1994.   
[19] J. Doyne Farmer, L\`azl\`o Gillemot, and Fabrizio Lillo. What really causes large price changes? Quantitative Finance, 4(4):383–397, 2004.   
[20] Peter Gomber, Uwe Schweickert, and Erik Theissen. Liquidity dynamics in an electronic open limit order book: An event study approach. European Financial Management, 21(1):52–78, 2015.   
[21] Jean-Philippe Bouchaud, Julien Kockelkoren, and Marc Potters. Random walks, liquidity molasses and critical response in financial markets. Quantitative finance, 6(02):115–123, 2006.   
[22] Ananth Madhavan, Matthew Richardson, and Mark Roomans. Why do security prices change? a transactionlevel analysis of nyse stocks. Review of Financial Studies, 10(4):1035–1064, 1997.   
[23] DE Taranto, G Bormetti, and F Lillo. The adaptive nature of liquidity taking in limit order books. Journal of Statistical Mechanics, 2014(6), 2014.   
[24] Fabrizio Lillo, J Doyne Farmer, et al. The long memory of the efficient market. Studies in nonlinear dynamics $\boldsymbol { \mathcal { E } }$ econometrics, 8(3):1, 2004.   
[25] Austin Gerig. A theory for market impact: How order flow affects stock price. Phd thesis, arxiv:0804.3818, University of Illinois, 2007.   
[26] Felix Patzelt and Klaus Pawelzik. An inherent instability of efficient markets. Sci. Rep., 3:2784, 2013.   
[27] Felix Patzelt and Klaus Pawelzik. Criticality of adaptive control dynamics. Phys. Rev. Lett., 107:238103, Dec 2011.   
[28] Eugene Fama. Efficient capital markets: A review of theory and empirical work. The Journal of Finance, 25(2):383–417, 1970.   
[29] Jean-Philippe Bouchaud, Yuval Gefen, Marc Potters, and Matthieu Wyart. Fluctuations and response in financial markets: the subtle nature of ‘random’price changes. Quantitative finance, 4(2):176–190, 2004.   
[30] Zoltan Eisler, Jean-Philippe Bouchaud, and Julien Kockelkoren. The price impact of order book events: market orders, limit orders and cancellations. Quantitative Finance, 12(9):1395–1419, 2012.   
[31] Damian Eduardo Taranto, Giacomo Bormetti, Jean-Philippe Bouchaud, Fabrizio Lillo, and Bence Toth. Linear models for the impact of order flow on prices i. propagators: Transient vs. history dependent impact. Preprint arXiv:1602.02735 [q-fin.TR], 2016.

# APPENDICES

# Appendix A: Single trade impacts

Fig. 6 shows mid-price-impacts for single (estimated) trades for different instruments. The impacts are dominated by a step at the origin and a highly concave dependency on volume. In other words: The one-trade impact strongly depends on the direction of the trade and much less on its volume. In practice, it is challenging to measure the true one-trade impact because it is not known which transactions belong to the same trade. As shown in the lowest row, merging transactions with the same signs and timestamps (solid lines) aggregates more trades than merging based on the trade id reported by the exchange (dashed lines). Unfortunately, since most available data does not contain trade-ids, one usually can only calculate an $N$ -trade impact with a small $N > 1$ Since we consider aggregate trades for $N \gtrsim 1 0$ in the following, however, this slight underestimation of the true sizes of the aggregation bins should only lead to minor quantitative differences. Note that the impacts could be measured using the transaction price instead of the midprice. In this case, the one-trade impact is dominated by the bid-ask-bounce and the aggregate impact quickly converges towards the one for the mid-price (not shown).

# Appendix B: Impact curves for 30 instruments

Fig. 7 shows aggregate order-volume-impacts for different instruments, for different $N$ , and rescaled according to Eq. 3. Aggregate impact is never fully linear and exhibits a universal shape on all intra-day scales of each instrument with small difference across instruments. Most notably, small tick instruments (like AAPL and GOOG) tend to have a saturating impact or even a small overshoot while large-tick instruments (like MSFT, the nordic stocks and the futures), do not fully saturate for large imbalances.

Fig. 8 shows aggregate order-sign-impacts for for different instruments. Similar results are found for the tradeimbalance in Figure 8. The only exception are the DAX futures, which seem to exhibit reverting impacts conditioned on large order-sign imbalances but not for large trade imbalances.

# Appendix C: Change probability curves for 30 instruments

Fig. 10 shows the price-change probability for different instruments. To emphasize the approximate invariance of the curve over a wide range of bin sizes for all but the most small-tick instruments, we here set the lowest bin-size to 32.

![](images/da62754e96cce4d21647e8ee376668bb0a351a2a80db107226bb6a7656e610d8.jpg)  
FIG. 6. Single-trade impacts as a function of the order volume imbalance. First two rows: NASDAQ stocks, 2012-2016. Rows three and four: OMX stocks, 2012-2016. Lowest row: EUREX futures (10/2014-12/2015). Solid lines: estimated trade-sign. Dotted lines: exchange-provided trade-signs (not available for hidden liquidity on NASDAQ). Dashed lines: exchange-provided sign and trade-id (only EUREX).

![](images/e3421b26625629f15c620733ce4b7a02e90d2b7c508fa36efa197b016cfdbbf4.jpg)  
FIG. 7. Price impact as a function of the order volume imbalance. The raw point-clouds were quantile-binned along the imbalance axis. Therefore the curves have a constant noise level but a range of imbalances that changes with the temporal bin size $N$ . Instruments and years as in Fig. 6.

![](images/df2d4146f84b0ddd7da016f0bbd6934d0119f052566b29b7961170b70719cb1b.jpg)  
FIG. 8. Price impact as a function of the order sign imbalance. Instruments and years as in Fig. 6.

![](images/57ea026241744fde5e236a24cbc55bc389e56b34964930cb47ee11bda58cacf7.jpg)  
FIG. 9. Price impact as a function of the trade imbalance. Instruments and years as in Fig. 6.

![](images/fe577107c47ac1fbf76cebcc15a945577c939dd9863b068dcec4c08888e8cb46.jpg)  
FIG. 10. Probability (within a bin) that the mid-price changes between two trades vs the mean sign. Instruments and years as in Fig. 6.